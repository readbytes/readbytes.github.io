<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>JavaScript Canvas Programming Working with Pixel Data and Filters</title>
<link rel='shortcut icon' href='https://java2s.com/style/favicon.ico'>
<link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material.css"> <!-- Dark theme -->
<script src="https://cdn.jsdelivr.net/npm/typescript@5/lib/typescript.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/htmlmixed/htmlmixed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/typescript.min.js"></script>
<style>
    #floatingLog {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(20, 20, 20, 0.95);
      color: white;
      font-family: monospace;
      font-size: 14px;
      padding: 16px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
      max-width: 80%;
      max-height: 200px;
      overflow-y: auto;
      display: none;
      z-index: 9999;
      pointer-events: none;
      white-space: pre-wrap;
      text-align: center;
    }
</style>
<script>
  const codeMirrorMap = new Map();
  const iframeMap = new Map();
  
 

  let dismissTimer;
  function showFloatingLog(message) {
	const floatingLog = document.getElementById('floatingLog');

    if (floatingLog.style.display !== 'block') {
      floatingLog.textContent = '';
      floatingLog.style.display = 'block'; 
    }

    floatingLog.textContent += message + '\n';
    floatingLog.scrollTop = floatingLog.scrollHeight; 
    clearTimeout(dismissTimer);
    dismissTimer = setTimeout(() => {
      floatingLog.style.display = 'none';
      floatingLog.textContent = '';
    }, 2000);
  }
  window.addEventListener('message', (event) => {
	    if (!iframeMap.has(event.source)) return;

	    if (event.data?.type === 'console-log') {
	      showFloatingLog(event.data.message);
	    }
  });  
  function renderIframe(button,textarea_id, iframe_id) {
      const html = codeMirrorMap.get(textarea_id).getValue();
      const iframe = document.getElementById(iframe_id);
  
      const oldIframe = iframe;
      const newIframe = document.createElement('iframe');
      newIframe.className ="result_iframe";
      
      newIframe.id = iframe_id;
      oldIframe.replaceWith(newIframe);
 

      // Track the iframe in the map
      iframeMap.set(newIframe.contentWindow, button);

      const overrideScript = `
        <script>
          (function() {
            const originalLog = console.log;
            console.log = function(...args) {
              originalLog.apply(console, args);
              window.parent.postMessage({
                type: 'console-log',
                message: args.map(a => {
                  try { return JSON.stringify(a); }
                  catch { return String(a); }
                }).join(' ')
              }, '*');
            };
          })();
        <\/script>
      `;

      const iframeHTML = `
        <!DOCTYPE html>
        <html>
        <body>
          ${overrideScript}
          ${html}
        </body>
        </html>
      `;
 
      const doc = newIframe.contentDocument || newIframe.contentWindow.document;
      doc.open();
      doc.write(iframeHTML);
      doc.close();

      
      setTimeout(() => {
    	  newIframe.style.height = '0px';
    	   let contentHeight = Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight);
 
    	   if(contentHeight < 150 || contentHeight > 600){
    		   contentHeight = 600;
    	   } 
    	   newIframe.style.height = contentHeight + 'px';
    	}, 50);      
      
  }
  function renderIframeForClientTypescript(textarea_id, iframe_id) {
      let code = codeMirrorMap.get(textarea_id).getValue();
      code = ts.transpile(code);
      const iframe = document.getElementById(iframe_id);
      const doc = iframe.contentDocument || iframe.contentWindow.document;

const html = `
  <!DOCTYPE html>
  <html>
    <head>
      <title>Output</title>
      <style>
        body { font-family: monospace; padding: 1em; background: #f4f4f4; color: #222; }
        pre { white-space: pre-wrap; word-break: break-word; }
        .error { color: red; }
      </style>
    </head>
    <body>
      <pre id="log"></pre>
      <script>
        (function(){
          const logEl = document.getElementById('log');
          const origLog = console.log;
          const origError = console.error;

          console.log = (...args) => {
            logEl.textContent += args.join(' ') + '\\n';
            origLog.apply(console, args);
          };
          console.table = (...args) => {
            logEl.textContent += args.join(' ') + '\\n';
            origLog.apply(console, args);
          };

          console.error = (...args) => {
            logEl.innerHTML +='<span class="error">' + args.join(' ') + '</span>';
            origError.apply(console, args);
          };
          window.addEventListener("error", function (event) {
              console.error("Caught by event listener:", event.message);
          });    
          try {             
              ${code};
          } catch (err) {
            console.error(err.stack || err.message);
          }
        })();
      <\/script>
    </body>
  </html>
`;

      iframe.style.display = "block";
      iframe.srcdoc = html;  
  }

    function renderIframeForClientJavascript(textarea_id, iframe_id) {
        const code = codeMirrorMap.get(textarea_id).getValue();
        const iframe = document.getElementById(iframe_id);
        const doc = iframe.contentDocument || iframe.contentWindow.document;

  const html = `
    <!DOCTYPE html>
    <html>
      <head>
        <title>Output</title>
        <style>
          body { font-family: monospace; padding: 1em; background: #1e1e1e; color: #eee; }
          pre { white-space: pre-wrap; word-break: break-word; }
          .error { color: red; }
        </style>
      </head>
      <body>
        <pre id="log"></pre>
        <script>
          (function(){
            const logEl = document.getElementById('log');
            const origLog = console.log;
            const origError = console.error;

            console.log = (...args) => {
              logEl.textContent += args.join(' ') + '\\n';
              origLog.apply(console, args);
            };
            console.table = (...args) => {
              logEl.textContent += args.join(' ') + '\\n';
              origLog.apply(console, args);
            };

            console.error = (...args) => {
              logEl.innerHTML +='<span class="error">' + args.join(' ') + '</span>';
              origError.apply(console, args);
            };
            window.addEventListener("error", function (event) {
                console.error("Caught by event listener:", event.message);
            });    
            try {
             ${code}; 
            } catch (err) {
              console.error(err.stack || err.message);
            }
          })();
        <\/script>
      </body>
    </html>
  `;
        iframe.style.display = "block";
        iframe.srcdoc = html;  
    }
    function toggleSnippetAndRefresh(id, textarea_id) {
      const box = document.getElementById(id);
      box.classList.toggle("open");
      codeMirrorMap.get(textarea_id).refresh();
    }

  </script>
  <script>
  const mode = localStorage.getItem('mode') || 'light';
  document.documentElement.classList.add(`${mode}-mode`);
  </script>   
<style> 
html {
  scroll-behavior: smooth;
}

body {
  font-family: 'Merriweather', serif;
  margin: 0;
  padding: 2rem 1rem;
  font-size: 15px;
  line-height: 1.5;
  transition: background-color 0.3s, color 0.3s;
}

.container {
  max-width: 700px;
  margin: 0 auto;
  padding: 1rem 2rem;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
}

h1, h2, h3 {
  font-weight: 600;
  margin-top: 2.5rem;
  margin-bottom: 1rem;
  line-height: 1.2;
}

h1 { font-size: 1.8rem; }
h2 { font-size: 1.4rem; }
h3 { font-size: 1.2rem; }

table {
  width: 100%;
  border-collapse: collapse;
  font-family: sans-serif;
  font-size: 1em;
  margin: 1em 0;
}

th, td {
  padding: 0.6em 1em;
  text-align: left;
  border: 1px solid;
}

tr:nth-child(even) {
  background-color: inherit;
}

tr:hover {
  background-color: inherit;
}

a {
  text-decoration: none;
  transition: color 0.2s;
}

a:hover {
  text-decoration: underline;
}

code {
  color: #d35400;
}

.book-title-chapter {
  font-family: 'Merriweather', serif;
  font-size: 2rem;
  font-weight: bold;
  text-align: center;
  margin-bottom: 2rem;
  border-bottom: 2px solid;
  padding-bottom: 0.5rem;
}

.book-subtitle-chapter {
  text-align: center;
  font-size: 1rem;
  margin-top: -1rem;
  margin-bottom: 2rem;
}

.related-books {
  margin-top: 40px;
}

.related-book-list {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
}

    .book-cover {
      width: 130px;
      height: 180px;
      font-family: Arial, sans-serif;
      position: relative;
      overflow: hidden;      
      line-height: normal;
      box-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    .book-cover-bottom-stripe {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 5px;
      width: 100%;
    }
    .book-cover-title {
      position: absolute;
      width: 100%;
      text-align: center;
      font-weight: bold;
    }
     
    .book-cover-icon {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      justify-content: center; 
    }

    .book-cover-author {
      position: absolute;
      bottom: 10px;
      width: 100%;
      text-align: center;
      font-size: 8px;
      color: #333;
    }

.page-footer {
  margin-top: 4rem;
  padding: 1rem 0;
  text-align: center;
  font-size: 0.85rem;
  border-top: 1px solid;
}

.chapter-navi-section {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 10px;
}

.nav-link {
  color: inherit;
  text-decoration: none;
  opacity: 0.5;
  transition: opacity 0.3s ease, text-decoration 0.3s ease;
}

.nav-link:hover {
  opacity: 0.9;
  text-decoration: underline;
}

.prev { text-align: left; }
.toc-link { text-align: center; }
.next { text-align: right; }

.download-section {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2rem;
  padding: 2rem 1rem;
  max-width: 600px;
  margin: 3rem auto;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.05);
}

.download-info h2 {
  margin: 0 0 0.5rem;
  font-size: 1.2rem;
}

.format-label {
  margin: 0 0 0.5rem;
  font-size: 0.95rem;
}

.download-buttons {
  display: flex;
  gap: 1rem;
}

.download-button {
  background-color: #4A90E2;
  color: white;
  padding: 0.5em 1.2em;
  border-radius: 25px;
  font-size: 0.95rem;
  text-decoration: none;
  transition: background-color 0.3s ease;
}

.download-button:hover {
  background-color: #357ABD;
}

.code-block {
  position: relative;
  margin-bottom: 1em;
}

.copy-button {
  background: transparent;
  color: white;
  position: absolute;
  top: 8px;
  right: 8px;
  border: none;
  padding: 4px 8px;
  font-size: 12px;
  border-radius: 4px;
  cursor: pointer;
  z-index: 1;
}

.copy-button:hover {
  background-color: #0056b3;
}

.snippet-container {
  overflow: hidden;
}

.snippet-header {
  padding: 0.75rem 1rem;
  cursor: pointer;
  font-size: 1rem;
    background-color: #eeeeee;
    color:  #111111; 
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);  
}

.snippet-body {
  display: none;
  font-family: monospace;
}

.snippet-container.open .snippet-body {
  display: block;
}

.CodeMirror {
  border: 2px solid #ccc;
  border-radius: 4px;
  resize: vertical;
}

/* === Light Mode === */
html.light-mode {
  background-color: #f8f7f5;
  color: #333;
}

html.light-mode .container {
  background: white;
}

html.light-mode .book-title-chapter {
  color: #2c3e50;
  border-color: #ccc;
}
html.light-mode .book-subtitle-chapter{
  color: #888;
}

html.light-mode .page-footer,
html.light-mode .series-name,
html.light-mode .book-subtitle,
html.light-mode .format-label {
  color: #888;
}

html.light-mode .related-books h2 {
  color: #333;
  border-bottom: 2px solid #eee;
}

html.light-mode .book-title {
  color: #fff;
}

html.light-mode .book-cover {
  border: 1px solid #ccc;
}

html.light-mode th {
  background-color: #f2f2f2;
}

html.light-mode tr:nth-child(even) {
  background-color: #fafafa;
}

html.light-mode tr:hover {
  background-color: #e6f7ff;
}

html.light-mode a,
html.light-mode .page-footer a {
  color: #000;
}

/* === Dark Mode === */
html.dark-mode {
  background-color: #181818;
  color: #e0e0e0;
}

html.dark-mode .container {
  background: #222;
}

html.dark-mode .book-title-chapter {
  color: #ddd;
  border-color: #444;
}

html.dark-mode .snippet-header {
    background-color: #333;
    color:  #ddd; 
}


html.dark-mode .book-subtitle-chapter,
html.dark-mode .page-footer,
html.dark-mode .series-name,
html.dark-mode .book-subtitle,
html.dark-mode .book-footer,
html.dark-mode .format-label {
  color: #aaa;
}

html.dark-mode .related-books h2 {
  color: #ddd;
  border-bottom: 2px solid #333;
}

html.dark-mode .book-title {
  color: #fff;
}

html.dark-mode .book-cover {
  border: 1px solid #555;
}

html.dark-mode th {
  background-color: #333;
  color: #fff;
}

html.dark-mode td {
  border-color: #444;
}

html.dark-mode tr:nth-child(even) {
  background-color: #2a2a2a;
}

html.dark-mode tr:hover {
  background-color: #2c3e50;
}

html.dark-mode a,
html.dark-mode .page-footer a {
  color: #eee;
}

    .dialog-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .dialog {
      background: white;
      padding: 20px;
      width: 90vw;
      height: 80vh;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
    }
    .dialog-content {
      display: flex;
      flex: 1;
      gap: 20px;
      margin-top: 10px;
    }
    .dialog h2 {
      margin-top: 0;
    }

    .textarea_dialog {
      width: 50%;
      height: 100%;
      resize: none;
      font-family: monospace;
      font-size: 14px;
      padding: 10px;
      box-sizing: border-box;
      border: 1px solid #ccc;
    }

    .iframe_dialog {
      width: 50%;
      height: 100%;
      border: 1px solid #ccc;
    }
    .controls_dialog {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }    
    button { padding: 0.5em 1em; background: green; color: white; border: none; cursor: pointer; }
    button:hover { background: #1e7e34; }
    .result_iframe { width:99%; height:200px; margin-top: 1em;  resize: both;border:1px solid #ccc;}        
</style>
</head>
<body> 
  <div class="container">
    <div class = "chapter-navi-section">
<a href="javascript-canvas-programming-working-with-canvas-state-and-compositing.htm" class="nav-button prev">←</a>
<a href='javascript-canvas-programming.htm#working-with-pixel-data-and-filters' class="nav-button toc-link">Index</a>
<a href="javascript-canvas-programming-3d-effects-and-webgl-basics.htm" class="nav-button next">→</a>
</div>

    <h1 class="book-title-chapter" id = 'top'>Working with Pixel Data and Filters</h1>
    <h3 class="book-subtitle-chapter">JavaScript Canvas Programming</h3>   
    <!-- <h1 class ="chapter-title"></h1> -->
    <h2 id='manipulating-pixels-directly'>11.1 Manipulating Pixels Directly</h2><p>One of the most powerful features of the HTML5 Canvas API is the ability to access and manipulate the raw pixel data of an image or canvas area. This gives you full control to create custom visual effects, analyze image content, or build complex filters — all by working directly with the RGBA color values of each pixel.</p><h3 id="accessing-raw-pixel-data-getimagedata">Accessing Raw Pixel Data: <code>getImageData()</code></h3><p>The method <code>getImageData(x, y, width, height)</code> extracts pixel data from a specified rectangular area on the canvas. It returns an <code>ImageData</code> object containing a <code>data</code> property — a one-dimensional <code>Uint8ClampedArray</code> holding the pixel colors.</p><h3 id="pixel-data-structure">Pixel Data Structure</h3><p>Each pixel consists of <strong>four consecutive bytes</strong> in this array representing:</p><ul>
 <li><strong>R</strong> (Red) — value from 0 to 255</li>
 <li><strong>G</strong> (Green) — value from 0 to 255</li>
 <li><strong>B</strong> (Blue) — value from 0 to 255</li>
 <li><strong>A</strong> (Alpha/opacity) — value from 0 (transparent) to 255 (opaque)</li>
</ul><p>The array length is therefore <code>width * height * 4</code>, and the pixel at <code>(x, y)</code> can be accessed using the index:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">const index = (y * width + x) * 4;</code></pre>
</div><h3 id="modifying-pixels-putimagedata">Modifying Pixels: <code>putImageData()</code></h3><p>After processing or modifying the pixel array, you can write the changes back to the canvas using <code>putImageData(imageData, dx, dy)</code>, which paints the pixel data onto the canvas at position <code>(dx, dy)</code>.</p><h3 id="example-highlighting-a-region-by-increasing-red-channel">Example: Highlighting a Region by Increasing Red Channel</h3><p>Below is an example that loads an image on the canvas, grabs its pixel data, then increases the red component for a rectangular area to create a red highlight effect:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-html">&lt;canvas id="canvas" width="300" height="200"&gt;&lt;/canvas&gt;
&lt;script&gt;
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  const img = new Image();
  img.src = 'https://readbytes.github.io/60x60/1.png';
  img.onload = () =&gt; {
    ctx.drawImage(img, 0, 0);

    // Get pixel data of entire canvas
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;

    // Highlight a rectangle area (50,50 to 150,150) by boosting red channel
    for (let y = 50; y &lt; 150; y++) {
      for (let x = 50; x &lt; 150; x++) {
        const idx = (y * canvas.width + x) * 4;
        data[idx] = Math.min(255, data[idx] + 100); // Increase red channel safely
      }
    }

    // Put the modified pixels back on the canvas
    ctx.putImageData(imageData, 0, 0);
  };
&lt;/script&gt;</code></pre>
</div><div class="snippet-container" id="iU0sp">
 <div id="HSXLN_Dialog" class="dialog-backdrop">
  <div class="dialog">
   <h2>Dialog 1</h2>
   <div class="controls"><button onclick="renderIframe(this,'QPEBh_Textarea','HSXLN_IFrame')">Run</button> <button onclick="closeAll()">Close</button>
   </div>
   <div class="dialog-content"><textarea id="QPEBh_Textarea" class="textarea_dialog" placeholder="Type HTML here...">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;canvas id="myCanvas" width="400" height="200" style="border:1px solid #ccc;"&gt;&lt;/canvas&gt;

&lt;script&gt;
  const canvas = document.getElementById("myCanvas");
  const ctx = canvas.getContext("2d");

  const img = new Image();
  img.src = 'https://readbytes.github.io/60x60/1.png';
  img.onload = () =&gt; {
    ctx.drawImage(img, 0, 0);

    // Get pixel data of entire canvas
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;

    // Highlight a rectangle area (50,50 to 150,150) by boosting red channel
    for (let y = 50; y &lt; 150; y++) {
      for (let x = 50; x &lt; 150; x++) {
        const idx = (y * canvas.width + x) * 4;
        data[idx] = Math.min(255, data[idx] + 100); // Increase red channel safely
      }
    }

    // Put the modified pixels back on the canvas
    ctx.putImageData(imageData, 0, 0);
  };
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <iframe id="HSXLN_IFrame" class="iframe_dialog"></iframe>
   </div>
  </div>
 </div>
 <div class="snippet-header" onclick="toggleSnippetAndRefresh('iU0sp','QPEBh')">
  Click to Try it <!--<span onclick="toggleSnippetAndRefresh('iU0sp','QPEBh')">Click
			to Try it</span> --> <!-- <span onclick="openDialog('HSXLN_Dialog')">Dialog</span> -->
 </div>
 <div class="snippet-body"><textarea id="QPEBh">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;canvas id="myCanvas" width="400" height="200" style="border:1px solid #ccc;"&gt;&lt;/canvas&gt;

&lt;script&gt;
  const canvas = document.getElementById("myCanvas");
  const ctx = canvas.getContext("2d");

  const img = new Image();
  img.src = 'https://readbytes.github.io/60x60/1.png';
  img.onload = () =&gt; {
    ctx.drawImage(img, 0, 0);

    // Get pixel data of entire canvas
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;

    // Highlight a rectangle area (50,50 to 150,150) by boosting red channel
    for (let y = 50; y &lt; 150; y++) {
      for (let x = 50; x &lt; 150; x++) {
        const idx = (y * canvas.width + x) * 4;
        data[idx] = Math.min(255, data[idx] + 100); // Increase red channel safely
      }
    }

    // Put the modified pixels back on the canvas
    ctx.putImageData(imageData, 0, 0);
  };
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <br> <button onclick="renderIframe(this,'QPEBh','HSXLN')">Run</button>
  <div id="HSXLN_FloatingLog" class="floatingLog" aria-live="polite" role="alert"></div> <iframe id="HSXLN" class="result_iframe" style="display: none;"></iframe>
  <script>
			{
				let editor = CodeMirror.fromTextArea(document
						.getElementById("QPEBh"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    const mode = localStorage.getItem("mode") || "light";  
			    const newTheme = mode === "dark" ? "material" : "default";
			    editor.setOption("theme", newTheme);
			    
				codeMirrorMap.set("QPEBh", editor);

				let editor1 = CodeMirror.fromTextArea(document.getElementById("QPEBh_Textarea"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    editor1.setOption("theme", newTheme);				
				
				codeMirrorMap.set("QPEBh_Textarea", editor1);
			}
		    function openDialog(id) {
		        closeAll();
		        document.getElementById(id).style.display = 'flex';
		        setTimeout(() => {
		        	 codeMirrorMap.get("QPEBh_Textarea").refresh();
		        }, 100); // 100ms 
		      }

		      function closeAll() {
		        document.querySelectorAll('.dialog-backdrop').forEach(el => {
		          el.style.display = 'none';
		        });
		      }			
		</script>
 </div>
</div><h3 id="more-advanced-uses-edge-detection-and-visual-effects">More Advanced Uses: Edge Detection and Visual Effects</h3><p>By reading pixel values and comparing neighbors, you can detect edges or transitions, e.g., applying simple Sobel or Laplacian filters. Similarly, you can invert colors, adjust brightness, or apply grayscale effects by altering R, G, B values accordingly.</p><h3 id="performance-considerations">Performance Considerations</h3><ul>
 <li><strong>Pixel Manipulation Is Costly</strong>: Accessing and writing pixel data causes CPU overhead, especially for large canvases or repeated animations.</li>
 <li><strong>Minimize Calls</strong>: Try to batch your pixel processing and avoid unnecessary repeated <code>getImageData()</code> or <code>putImageData()</code> calls.</li>
 <li><strong>Use Offscreen Canvases</strong>: For heavy processing, consider using offscreen canvases or Web Workers to prevent UI blocking.</li>
 <li><strong>Clamp Values</strong>: The <code>Uint8ClampedArray</code> clamps out-of-range values (less than 0 or greater than 255), which simplifies color calculations.</li>
</ul><h3 id="summary">Summary</h3><p>Working directly with pixel data unlocks infinite possibilities for custom image effects and analysis on the canvas. By understanding the RGBA data structure and efficiently looping through pixel arrays, you can build sophisticated filters and visuals, with awareness of the performance trade-offs involved.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='javascript-canvas-programming.htm#working-with-pixel-data-and-filters' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='creating-custom-filters-and-effects'>11.2 Creating Custom Filters and Effects</h2><p>After learning how to access and manipulate raw pixel data, the next step is to create custom filters and effects. These filters transform the image in creative ways, such as adjusting brightness, contrast, or applying blur and sharpening. Many effects rely on <strong>pixel math</strong> and <strong>convolution</strong> techniques to process image data.</p><h3 id="brightness-and-contrast-adjustments">Brightness and Contrast Adjustments</h3><p>Brightness and contrast filters directly modify the color values of each pixel.</p><ul>
 <li><strong>Brightness</strong>: Increase or decrease each color channel by a constant.</li>
 <li><strong>Contrast</strong>: Scale pixel color values around the midpoint (128) to increase or decrease contrast.</li>
</ul><p>Here’s a simple example function that applies brightness and contrast:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">function applyBrightnessContrast(imageData, brightness = 0, contrast = 0) {
  const data = imageData.data;
  const factor = (259 * (contrast + 255)) / (255 * (259 - contrast));

  for (let i = 0; i &lt; data.length; i += 4) {
    // Apply brightness (add) and contrast (scale)
    data[i] = truncate(factor * (data[i] - 128) + 128 + brightness);     // Red
    data[i + 1] = truncate(factor * (data[i + 1] - 128) + 128 + brightness); // Green
    data[i + 2] = truncate(factor * (data[i + 2] - 128) + 128 + brightness); // Blue
  }

  return imageData;
}

function truncate(value) {
  return Math.min(255, Math.max(0, value));
}</code></pre>
</div><h3 id="convolution-filters-blur-sharpen-edge-detection">Convolution Filters: Blur, Sharpen, Edge Detection</h3><p>Many image effects are built using <strong>convolution</strong>, a process where each pixel is recalculated based on a weighted sum of its neighbors. The weights are defined by a <strong>kernel matrix</strong>.</p><h3 id="how-convolution-works">How Convolution Works</h3><ul>
 <li>For each pixel, multiply neighboring pixel values by the corresponding kernel values.</li>
 <li>Sum these products to get the new pixel value.</li>
 <li>Apply this separately for R, G, and B channels.</li>
</ul><h3 id="common-kernels">Common Kernels</h3><table>
 <thead>
  <tr>
   <th>Effect</th>
   <th>Kernel Example (3x3)</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>Blur</td>
   <td>1/9 × [[1,1,1], [1,1,1], [1,1,1]]</td>
  </tr>
  <tr>
   <td>Sharpen</td>
   <td>[[0,-1,0], [-1,5,-1], [0,-1,0]]</td>
  </tr>
  <tr>
   <td>Edge Detect</td>
   <td>[[-1,-1,-1], [-1,8,-1], [-1,-1,-1]]</td>
  </tr>
 </tbody>
</table><h3 id="reusable-convolution-function">Reusable Convolution Function</h3><p>Here’s a generic function to apply a convolution kernel to an image:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">function applyConvolution(imageData, kernel, divisor = 1, offset = 0) {
  const { width, height, data } = imageData;
  const output = new Uint8ClampedArray(data.length);
  const side = Math.sqrt(kernel.length);
  const half = Math.floor(side / 2);

  for (let y = 0; y &lt; height; y++) {
    for (let x = 0; x &lt; width; x++) {
      let r = 0, g = 0, b = 0;

      for (let ky = 0; ky &lt; side; ky++) {
        for (let kx = 0; kx &lt; side; kx++) {
          const px = x + kx - half;
          const py = y + ky - half;

          if (px &gt;= 0 &amp;&amp; px &lt; width &amp;&amp; py &gt;= 0 &amp;&amp; py &lt; height) {
            const idx = (py * width + px) * 4;
            const weight = kernel[ky * side + kx];
            r += data[idx] * weight;
            g += data[idx + 1] * weight;
            b += data[idx + 2] * weight;
          }
        }
      }

      const i = (y * width + x) * 4;
      output[i] = truncate(r / divisor + offset);
      output[i + 1] = truncate(g / divisor + offset);
      output[i + 2] = truncate(b / divisor + offset);
      output[i + 3] = data[i + 3]; // copy alpha
    }
  }

  // Copy output back to imageData.data
  for (let i = 0; i &lt; output.length; i++) {
    data[i] = output[i];
  }

  return imageData;
}</code></pre>
</div><h3 id="example-applying-a-blur-filter">Example: Applying a Blur Filter</h3><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">const blurKernel = [
  1, 1, 1,
  1, 1, 1,
  1, 1, 1
];
const divisor = 9; // Sum of kernel weights

// Use like this:
const blurredImageData = applyConvolution(imageData, blurKernel, divisor);
ctx.putImageData(blurredImageData, 0, 0);</code></pre>
</div><h3 id="building-a-modular-filter-pipeline">Building a Modular Filter Pipeline</h3><p>You can chain multiple filters by applying one after another:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">function applyFilters(imageData, filters) {
  return filters.reduce((imgData, filter) =&gt; filter(imgData), imageData);
}

// Example usage
const filters = [
  imgData =&gt; applyBrightnessContrast(imgData, 20, 40),
  imgData =&gt; applyConvolution(imgData, blurKernel, 9)
];
const result = applyFilters(imageData, filters);
ctx.putImageData(result, 0, 0);</code></pre>
</div><div class="snippet-container" id="2jrNc">
 <div id="YaeBK_Dialog" class="dialog-backdrop">
  <div class="dialog">
   <h2>Dialog 1</h2>
   <div class="controls"><button onclick="renderIframe(this,'pYtNQ_Textarea','YaeBK_IFrame')">Run</button> <button onclick="closeAll()">Close</button>
   </div>
   <div class="dialog-content"><textarea id="pYtNQ_Textarea" class="textarea_dialog" placeholder="Type HTML here...">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8" /&gt;
&lt;title&gt;Brightness, Contrast &amp; Convolution Filters&lt;/title&gt;
&lt;style&gt;
  body { font-family: sans-serif; padding: 20px; background: #fafafa; }
  canvas { border: 1px solid #ccc; margin-top: 10px; max-width: 100%; }
  button, input[type="range"] { margin: 5px; }
  label { display: block; margin-top: 10px; }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h2&gt;Image Filters: Brightness, Contrast, Blur, Sharpen, Edge Detect&lt;/h2&gt;

&lt;input type="file" id="upload" accept="image/*" /&gt;
&lt;br/&gt;

&lt;label&gt;
  Brightness: &lt;input type="range" id="brightness" min="-100" max="100" value="0" /&gt;
&lt;/label&gt;
&lt;label&gt;
  Contrast: &lt;input type="range" id="contrast" min="-100" max="100" value="0" /&gt;
&lt;/label&gt;

&lt;button id="blurBtn"&gt;Blur&lt;/button&gt;
&lt;button id="sharpenBtn"&gt;Sharpen&lt;/button&gt;
&lt;button id="edgeBtn"&gt;Edge Detect&lt;/button&gt;
&lt;button id="resetBtn"&gt;Reset&lt;/button&gt;

&lt;br/&gt;

&lt;canvas id="canvas" width="600" height="400"&gt;&lt;/canvas&gt;

&lt;script&gt;
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const upload = document.getElementById('upload');
const brightnessSlider = document.getElementById('brightness');
const contrastSlider = document.getElementById('contrast');
const blurBtn = document.getElementById('blurBtn');
const sharpenBtn = document.getElementById('sharpenBtn');
const edgeBtn = document.getElementById('edgeBtn');
const resetBtn = document.getElementById('resetBtn');

let originalImageData = null;
let currentImageData = null;

// Helpers
function truncate(value) {
  return Math.min(255, Math.max(0, value));
}

function applyBrightnessContrast(imageData, brightness = 0, contrast = 0) {
  const data = imageData.data;
  const factor = (259 * (contrast + 255)) / (255 * (259 - contrast));

  for (let i = 0; i &lt; data.length; i += 4) {
    data[i]     = truncate(factor * (data[i] - 128) + 128 + brightness);     // R
    data[i + 1] = truncate(factor * (data[i + 1] - 128) + 128 + brightness); // G
    data[i + 2] = truncate(factor * (data[i + 2] - 128) + 128 + brightness); // B
  }
  return imageData;
}

function applyConvolution(imageData, kernel, divisor = 1, offset = 0) {
  const { width, height, data } = imageData;
  const output = new Uint8ClampedArray(data.length);
  const side = Math.sqrt(kernel.length);
  const half = Math.floor(side / 2);

  for (let y = 0; y &lt; height; y++) {
    for (let x = 0; x &lt; width; x++) {
      let r = 0, g = 0, b = 0;

      for (let ky = 0; ky &lt; side; ky++) {
        for (let kx = 0; kx &lt; side; kx++) {
          const px = x + kx - half;
          const py = y + ky - half;

          if (px &gt;= 0 &amp;&amp; px &lt; width &amp;&amp; py &gt;= 0 &amp;&amp; py &lt; height) {
            const idx = (py * width + px) * 4;
            const weight = kernel[ky * side + kx];
            r += data[idx] * weight;
            g += data[idx + 1] * weight;
            b += data[idx + 2] * weight;
          }
        }
      }

      const i = (y * width + x) * 4;
      output[i] = truncate(r / divisor + offset);
      output[i + 1] = truncate(g / divisor + offset);
      output[i + 2] = truncate(b / divisor + offset);
      output[i + 3] = data[i + 3]; // alpha
    }
  }

  for (let i = 0; i &lt; output.length; i++) {
    data[i] = output[i];
  }

  return imageData;
}

// Kernels
const blurKernel = [
  1, 1, 1,
  1, 1, 1,
  1, 1, 1
];

const sharpenKernel = [
  0, -1, 0,
  -1, 5, -1,
  0, -1, 0
];

const edgeKernel = [
  -1, -1, -1,
  -1, 8, -1,
  -1, -1, -1
];

// Render image data on canvas
function render(imageData) {
  ctx.putImageData(imageData, 0, 0);
  currentImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
}

// Upload image handler
upload.addEventListener('change', e =&gt; {
  const file = e.target.files[0];
  if (!file) return;

  const img = new Image();
  img.onload = () =&gt; {
    // Resize canvas to image size
    canvas.width = img.width;
    canvas.height = img.height;

    ctx.drawImage(img, 0, 0);
    originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    currentImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

    // Reset sliders
    brightnessSlider.value = 0;
    contrastSlider.value = 0;
  };
  img.src = URL.createObjectURL(file);
});

// Update brightness and contrast live
function updateBrightnessContrast() {
  if (!originalImageData) return;
  const brightness = parseInt(brightnessSlider.value, 10);
  const contrast = parseInt(contrastSlider.value, 10);

  // Clone originalImageData to avoid stacking effects
  let imageCopy = new ImageData(
    new Uint8ClampedArray(originalImageData.data),
    originalImageData.width,
    originalImageData.height
  );

  applyBrightnessContrast(imageCopy, brightness, contrast);
  render(imageCopy);
}

brightnessSlider.addEventListener('input', updateBrightnessContrast);
contrastSlider.addEventListener('input', updateBrightnessContrast);

// Convolution button handlers
blurBtn.addEventListener('click', () =&gt; {
  if (!currentImageData) return;
  applyConvolution(currentImageData, blurKernel, 9);
  render(currentImageData);
});
sharpenBtn.addEventListener('click', () =&gt; {
  if (!currentImageData) return;
  applyConvolution(currentImageData, sharpenKernel, 1);
  render(currentImageData);
});
edgeBtn.addEventListener('click', () =&gt; {
  if (!currentImageData) return;
  applyConvolution(currentImageData, edgeKernel, 1);
  render(currentImageData);
});

// Reset button
resetBtn.addEventListener('click', () =&gt; {
  if (!originalImageData) return;
  brightnessSlider.value = 0;
  contrastSlider.value = 0;
  render(originalImageData);
});
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <iframe id="YaeBK_IFrame" class="iframe_dialog"></iframe>
   </div>
  </div>
 </div>
 <div class="snippet-header" onclick="toggleSnippetAndRefresh('2jrNc','pYtNQ')">
  Click to Try it <!--<span onclick="toggleSnippetAndRefresh('2jrNc','pYtNQ')">Click
			to Try it</span> --> <!-- <span onclick="openDialog('YaeBK_Dialog')">Dialog</span> -->
 </div>
 <div class="snippet-body"><textarea id="pYtNQ">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8" /&gt;
&lt;title&gt;Brightness, Contrast &amp; Convolution Filters&lt;/title&gt;
&lt;style&gt;
  body { font-family: sans-serif; padding: 20px; background: #fafafa; }
  canvas { border: 1px solid #ccc; margin-top: 10px; max-width: 100%; }
  button, input[type="range"] { margin: 5px; }
  label { display: block; margin-top: 10px; }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h2&gt;Image Filters: Brightness, Contrast, Blur, Sharpen, Edge Detect&lt;/h2&gt;

&lt;input type="file" id="upload" accept="image/*" /&gt;
&lt;br/&gt;

&lt;label&gt;
  Brightness: &lt;input type="range" id="brightness" min="-100" max="100" value="0" /&gt;
&lt;/label&gt;
&lt;label&gt;
  Contrast: &lt;input type="range" id="contrast" min="-100" max="100" value="0" /&gt;
&lt;/label&gt;

&lt;button id="blurBtn"&gt;Blur&lt;/button&gt;
&lt;button id="sharpenBtn"&gt;Sharpen&lt;/button&gt;
&lt;button id="edgeBtn"&gt;Edge Detect&lt;/button&gt;
&lt;button id="resetBtn"&gt;Reset&lt;/button&gt;

&lt;br/&gt;

&lt;canvas id="canvas" width="600" height="400"&gt;&lt;/canvas&gt;

&lt;script&gt;
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const upload = document.getElementById('upload');
const brightnessSlider = document.getElementById('brightness');
const contrastSlider = document.getElementById('contrast');
const blurBtn = document.getElementById('blurBtn');
const sharpenBtn = document.getElementById('sharpenBtn');
const edgeBtn = document.getElementById('edgeBtn');
const resetBtn = document.getElementById('resetBtn');

let originalImageData = null;
let currentImageData = null;

// Helpers
function truncate(value) {
  return Math.min(255, Math.max(0, value));
}

function applyBrightnessContrast(imageData, brightness = 0, contrast = 0) {
  const data = imageData.data;
  const factor = (259 * (contrast + 255)) / (255 * (259 - contrast));

  for (let i = 0; i &lt; data.length; i += 4) {
    data[i]     = truncate(factor * (data[i] - 128) + 128 + brightness);     // R
    data[i + 1] = truncate(factor * (data[i + 1] - 128) + 128 + brightness); // G
    data[i + 2] = truncate(factor * (data[i + 2] - 128) + 128 + brightness); // B
  }
  return imageData;
}

function applyConvolution(imageData, kernel, divisor = 1, offset = 0) {
  const { width, height, data } = imageData;
  const output = new Uint8ClampedArray(data.length);
  const side = Math.sqrt(kernel.length);
  const half = Math.floor(side / 2);

  for (let y = 0; y &lt; height; y++) {
    for (let x = 0; x &lt; width; x++) {
      let r = 0, g = 0, b = 0;

      for (let ky = 0; ky &lt; side; ky++) {
        for (let kx = 0; kx &lt; side; kx++) {
          const px = x + kx - half;
          const py = y + ky - half;

          if (px &gt;= 0 &amp;&amp; px &lt; width &amp;&amp; py &gt;= 0 &amp;&amp; py &lt; height) {
            const idx = (py * width + px) * 4;
            const weight = kernel[ky * side + kx];
            r += data[idx] * weight;
            g += data[idx + 1] * weight;
            b += data[idx + 2] * weight;
          }
        }
      }

      const i = (y * width + x) * 4;
      output[i] = truncate(r / divisor + offset);
      output[i + 1] = truncate(g / divisor + offset);
      output[i + 2] = truncate(b / divisor + offset);
      output[i + 3] = data[i + 3]; // alpha
    }
  }

  for (let i = 0; i &lt; output.length; i++) {
    data[i] = output[i];
  }

  return imageData;
}

// Kernels
const blurKernel = [
  1, 1, 1,
  1, 1, 1,
  1, 1, 1
];

const sharpenKernel = [
  0, -1, 0,
  -1, 5, -1,
  0, -1, 0
];

const edgeKernel = [
  -1, -1, -1,
  -1, 8, -1,
  -1, -1, -1
];

// Render image data on canvas
function render(imageData) {
  ctx.putImageData(imageData, 0, 0);
  currentImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
}

// Upload image handler
upload.addEventListener('change', e =&gt; {
  const file = e.target.files[0];
  if (!file) return;

  const img = new Image();
  img.onload = () =&gt; {
    // Resize canvas to image size
    canvas.width = img.width;
    canvas.height = img.height;

    ctx.drawImage(img, 0, 0);
    originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    currentImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

    // Reset sliders
    brightnessSlider.value = 0;
    contrastSlider.value = 0;
  };
  img.src = URL.createObjectURL(file);
});

// Update brightness and contrast live
function updateBrightnessContrast() {
  if (!originalImageData) return;
  const brightness = parseInt(brightnessSlider.value, 10);
  const contrast = parseInt(contrastSlider.value, 10);

  // Clone originalImageData to avoid stacking effects
  let imageCopy = new ImageData(
    new Uint8ClampedArray(originalImageData.data),
    originalImageData.width,
    originalImageData.height
  );

  applyBrightnessContrast(imageCopy, brightness, contrast);
  render(imageCopy);
}

brightnessSlider.addEventListener('input', updateBrightnessContrast);
contrastSlider.addEventListener('input', updateBrightnessContrast);

// Convolution button handlers
blurBtn.addEventListener('click', () =&gt; {
  if (!currentImageData) return;
  applyConvolution(currentImageData, blurKernel, 9);
  render(currentImageData);
});
sharpenBtn.addEventListener('click', () =&gt; {
  if (!currentImageData) return;
  applyConvolution(currentImageData, sharpenKernel, 1);
  render(currentImageData);
});
edgeBtn.addEventListener('click', () =&gt; {
  if (!currentImageData) return;
  applyConvolution(currentImageData, edgeKernel, 1);
  render(currentImageData);
});

// Reset button
resetBtn.addEventListener('click', () =&gt; {
  if (!originalImageData) return;
  brightnessSlider.value = 0;
  contrastSlider.value = 0;
  render(originalImageData);
});
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <br> <button onclick="renderIframe(this,'pYtNQ','YaeBK')">Run</button>
  <div id="YaeBK_FloatingLog" class="floatingLog" aria-live="polite" role="alert"></div> <iframe id="YaeBK" class="result_iframe" style="display: none;"></iframe>
  <script>
			{
				let editor = CodeMirror.fromTextArea(document
						.getElementById("pYtNQ"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    const mode = localStorage.getItem("mode") || "light";  
			    const newTheme = mode === "dark" ? "material" : "default";
			    editor.setOption("theme", newTheme);
			    
				codeMirrorMap.set("pYtNQ", editor);

				let editor1 = CodeMirror.fromTextArea(document.getElementById("pYtNQ_Textarea"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    editor1.setOption("theme", newTheme);				
				
				codeMirrorMap.set("pYtNQ_Textarea", editor1);
			}
		    function openDialog(id) {
		        closeAll();
		        document.getElementById(id).style.display = 'flex';
		        setTimeout(() => {
		        	 codeMirrorMap.get("pYtNQ_Textarea").refresh();
		        }, 100); // 100ms 
		      }

		      function closeAll() {
		        document.querySelectorAll('.dialog-backdrop').forEach(el => {
		          el.style.display = 'none';
		        });
		      }			
		</script>
 </div>
</div><h3 id="summary-and-experimentation">Summary and Experimentation</h3><p>Creating custom filters with pixel math and convolution empowers you to build endless effects — from subtle adjustments like brightness to artistic styles like sharpening or edge detection.</p><ul>
 <li>Experiment with different kernel matrices to see how they affect the image.</li>
 <li>Adjust filter parameters for dynamic results.</li>
 <li>Use modular pipelines to combine multiple effects smoothly.</li>
</ul><p>In the next sections, we’ll explore how to optimize these filters and build interactive tools around them.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='javascript-canvas-programming.htm#working-with-pixel-data-and-filters' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='using-offscreen-canvases-for-performance'>11.3 Using Offscreen Canvases for Performance</h2><p>When working with pixel data and complex image filters, performance can become a concern—especially when manipulating large images or running animations. The <strong><code>OffscreenCanvas</code></strong> API offers a way to improve rendering efficiency by allowing canvas drawing and processing to happen off the main UI thread, which keeps the interface smooth and responsive.</p><h3 id="what-is-offscreencanvas">What Is <code>OffscreenCanvas</code>?</h3><p><code>OffscreenCanvas</code> is a canvas element that exists <strong>entirely off the visible document</strong>, meaning it is not part of the DOM. It can be used to:</p><ul>
 <li>Perform drawing operations without blocking the main thread.</li>
 <li>Work with Web Workers for multi-threaded rendering.</li>
 <li>Cache expensive drawing or filtering results.</li>
 <li>Prepare images or graphics in the background before displaying them on the visible canvas.</li>
</ul><p>This contrasts with the traditional method of creating a hidden canvas via:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">const hiddenCanvas = document.createElement('canvas');</code></pre>
</div><p>which still runs on the main thread but simply isn’t added to the page.</p><h3 id="creating-and-using-an-offscreen-canvas">Creating and Using an Offscreen Canvas</h3><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">// Create an offscreen canvas of width 300, height 150
const offscreen = new OffscreenCanvas(300, 150);
const ctx = offscreen.getContext('2d');

// Draw or manipulate image data offscreen
ctx.fillStyle = 'blue';
ctx.fillRect(0, 0, 300, 150);

// Later, transfer or draw this offscreen canvas onto a visible canvas
const visibleCanvas = document.getElementById('myCanvas');
const visibleCtx = visibleCanvas.getContext('2d');

// Draw offscreen canvas onto visible canvas
visibleCtx.drawImage(offscreen, 0, 0);</code></pre>
</div><h3 id="using-offscreencanvas-with-image-processing">Using OffscreenCanvas with Image Processing</h3><p>You can perform filtering or pixel manipulation off the main thread:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">// Example: applying filter offscreen and then rendering

function applyFilterOffscreen(imageBitmap) {
  const offscreen = new OffscreenCanvas(imageBitmap.width, imageBitmap.height);
  const ctx = offscreen.getContext('2d');
  ctx.drawImage(imageBitmap, 0, 0);

  let imageData = ctx.getImageData(0, 0, offscreen.width, offscreen.height);
  
  // Modify pixel data here (e.g., grayscale or invert)
  // ... pixel manipulation code ...

  ctx.putImageData(imageData, 0, 0);

  return offscreen.transferToImageBitmap(); // Efficiently transfers for rendering
}</code></pre>
</div><p>This approach enables you to keep your UI responsive, especially during heavy image processing tasks.</p><h3 id="offscreencanvas-vs-hidden-dom-canvas">OffscreenCanvas vs Hidden DOM Canvas</h3><table>
 <thead>
  <tr>
   <th>Feature</th>
   <th>OffscreenCanvas</th>
   <th>Hidden DOM Canvas</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>Runs on Main Thread</td>
   <td>No, can run on worker threads</td>
   <td>Yes</td>
  </tr>
  <tr>
   <td>Visible in DOM</td>
   <td>No</td>
   <td>No (if not appended)</td>
  </tr>
  <tr>
   <td>Performance Benefit</td>
   <td>Higher, multi-threading</td>
   <td>Limited to main thread</td>
  </tr>
  <tr>
   <td>API Availability</td>
   <td>Modern browsers only</td>
   <td>Universal</td>
  </tr>
 </tbody>
</table><h3 id="browser-support-and-fallbacks">Browser Support and Fallbacks</h3><ul>
 <li><strong>Modern browsers</strong> like Chrome, Firefox, Edge support <code>OffscreenCanvas</code>, but <strong>Safari support is limited or missing</strong>.</li>
 <li>When <code>OffscreenCanvas</code> is not available, fallback to creating a hidden canvas in the DOM:</li>
</ul><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">function createCanvas(width, height) {
  if (typeof OffscreenCanvas !== 'undefined') {
    return new OffscreenCanvas(width, height);
  } else {
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    return canvas;
  }
}</code></pre>
</div><div class="snippet-container" id="ce6Cr">
 <div id="uZ2hI_Dialog" class="dialog-backdrop">
  <div class="dialog">
   <h2>Dialog 1</h2>
   <div class="controls"><button onclick="renderIframe(this,'3jldX_Textarea','uZ2hI_IFrame')">Run</button> <button onclick="closeAll()">Close</button>
   </div>
   <div class="dialog-content"><textarea id="3jldX_Textarea" class="textarea_dialog" placeholder="Type HTML here...">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8" /&gt;
  &lt;title&gt;OffscreenCanvas Demo&lt;/title&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid #ccc;
      margin-top: 10px;
      width: 300px;
      height: 150px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h3&gt;OffscreenCanvas Drawing Demo&lt;/h3&gt;
&lt;canvas id="myCanvas" width="300" height="150"&gt;&lt;/canvas&gt;

&lt;script&gt;
  // Utility to create OffscreenCanvas or fallback hidden DOM canvas
  function createCanvas(width, height) {
    if (typeof OffscreenCanvas !== 'undefined') {
      return new OffscreenCanvas(width, height);
    } else {
      const canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      canvas.style.display = 'none';
      document.body.appendChild(canvas);
      return canvas;
    }
  }

  // Create offscreen canvas of size 300x150
  const offscreen = createCanvas(300, 150);
  const ctx = offscreen.getContext('2d');

  // Draw something on offscreen canvas
  ctx.fillStyle = 'blue';
  ctx.fillRect(0, 0, 300, 150);
  ctx.fillStyle = 'white';
  ctx.font = '24px sans-serif';
  ctx.fillText('Offscreen Canvas!', 50, 80);

  // Draw offscreen canvas content onto visible canvas
  const visibleCanvas = document.getElementById('myCanvas');
  const visibleCtx = visibleCanvas.getContext('2d');

  // If OffscreenCanvas supports transferToImageBitmap (modern), use it
  if (offscreen instanceof OffscreenCanvas &amp;&amp; typeof offscreen.transferToImageBitmap === 'function') {
    const bitmap = offscreen.transferToImageBitmap();
    visibleCtx.drawImage(bitmap, 0, 0);
  } else {
    // Otherwise, just draw the fallback hidden canvas directly
    visibleCtx.drawImage(offscreen, 0, 0);
  }

  // Example function to demonstrate offscreen filtering and returning ImageBitmap
  async function applyFilterOffscreen(imageBitmap) {
    const offscreenFilterCanvas = createCanvas(imageBitmap.width, imageBitmap.height);
    const offscreenCtx = offscreenFilterCanvas.getContext('2d');
    offscreenCtx.drawImage(imageBitmap, 0, 0);

    let imageData = offscreenCtx.getImageData(0, 0, offscreenFilterCanvas.width, offscreenFilterCanvas.height);

    // Simple invert filter
    for (let i = 0; i &lt; imageData.data.length; i += 4) {
      imageData.data[i] = 255 - imageData.data[i];       // R
      imageData.data[i+1] = 255 - imageData.data[i+1];   // G
      imageData.data[i+2] = 255 - imageData.data[i+2];   // B
    }

    offscreenCtx.putImageData(imageData, 0, 0);

    if (offscreenFilterCanvas instanceof OffscreenCanvas &amp;&amp; typeof offscreenFilterCanvas.transferToImageBitmap === 'function') {
      return offscreenFilterCanvas.transferToImageBitmap();
    } else {
      // For fallback, create ImageBitmap from canvas
      return createImageBitmap(offscreenFilterCanvas);
    }
  }

  // (Optional) Usage example: invert colors after 2 seconds
  setTimeout(async () =&gt; {
    if (offscreen instanceof OffscreenCanvas &amp;&amp; typeof offscreen.transferToImageBitmap === 'function') {
      const bitmap = offscreen.transferToImageBitmap();
      const invertedBitmap = await applyFilterOffscreen(bitmap);
      visibleCtx.clearRect(0, 0, visibleCanvas.width, visibleCanvas.height);
      visibleCtx.drawImage(invertedBitmap, 0, 0);
    }
  }, 2000);

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <iframe id="uZ2hI_IFrame" class="iframe_dialog"></iframe>
   </div>
  </div>
 </div>
 <div class="snippet-header" onclick="toggleSnippetAndRefresh('ce6Cr','3jldX')">
  Click to Try it <!--<span onclick="toggleSnippetAndRefresh('ce6Cr','3jldX')">Click
			to Try it</span> --> <!-- <span onclick="openDialog('uZ2hI_Dialog')">Dialog</span> -->
 </div>
 <div class="snippet-body"><textarea id="3jldX">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8" /&gt;
  &lt;title&gt;OffscreenCanvas Demo&lt;/title&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid #ccc;
      margin-top: 10px;
      width: 300px;
      height: 150px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h3&gt;OffscreenCanvas Drawing Demo&lt;/h3&gt;
&lt;canvas id="myCanvas" width="300" height="150"&gt;&lt;/canvas&gt;

&lt;script&gt;
  // Utility to create OffscreenCanvas or fallback hidden DOM canvas
  function createCanvas(width, height) {
    if (typeof OffscreenCanvas !== 'undefined') {
      return new OffscreenCanvas(width, height);
    } else {
      const canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      canvas.style.display = 'none';
      document.body.appendChild(canvas);
      return canvas;
    }
  }

  // Create offscreen canvas of size 300x150
  const offscreen = createCanvas(300, 150);
  const ctx = offscreen.getContext('2d');

  // Draw something on offscreen canvas
  ctx.fillStyle = 'blue';
  ctx.fillRect(0, 0, 300, 150);
  ctx.fillStyle = 'white';
  ctx.font = '24px sans-serif';
  ctx.fillText('Offscreen Canvas!', 50, 80);

  // Draw offscreen canvas content onto visible canvas
  const visibleCanvas = document.getElementById('myCanvas');
  const visibleCtx = visibleCanvas.getContext('2d');

  // If OffscreenCanvas supports transferToImageBitmap (modern), use it
  if (offscreen instanceof OffscreenCanvas &amp;&amp; typeof offscreen.transferToImageBitmap === 'function') {
    const bitmap = offscreen.transferToImageBitmap();
    visibleCtx.drawImage(bitmap, 0, 0);
  } else {
    // Otherwise, just draw the fallback hidden canvas directly
    visibleCtx.drawImage(offscreen, 0, 0);
  }

  // Example function to demonstrate offscreen filtering and returning ImageBitmap
  async function applyFilterOffscreen(imageBitmap) {
    const offscreenFilterCanvas = createCanvas(imageBitmap.width, imageBitmap.height);
    const offscreenCtx = offscreenFilterCanvas.getContext('2d');
    offscreenCtx.drawImage(imageBitmap, 0, 0);

    let imageData = offscreenCtx.getImageData(0, 0, offscreenFilterCanvas.width, offscreenFilterCanvas.height);

    // Simple invert filter
    for (let i = 0; i &lt; imageData.data.length; i += 4) {
      imageData.data[i] = 255 - imageData.data[i];       // R
      imageData.data[i+1] = 255 - imageData.data[i+1];   // G
      imageData.data[i+2] = 255 - imageData.data[i+2];   // B
    }

    offscreenCtx.putImageData(imageData, 0, 0);

    if (offscreenFilterCanvas instanceof OffscreenCanvas &amp;&amp; typeof offscreenFilterCanvas.transferToImageBitmap === 'function') {
      return offscreenFilterCanvas.transferToImageBitmap();
    } else {
      // For fallback, create ImageBitmap from canvas
      return createImageBitmap(offscreenFilterCanvas);
    }
  }

  // (Optional) Usage example: invert colors after 2 seconds
  setTimeout(async () =&gt; {
    if (offscreen instanceof OffscreenCanvas &amp;&amp; typeof offscreen.transferToImageBitmap === 'function') {
      const bitmap = offscreen.transferToImageBitmap();
      const invertedBitmap = await applyFilterOffscreen(bitmap);
      visibleCtx.clearRect(0, 0, visibleCanvas.width, visibleCanvas.height);
      visibleCtx.drawImage(invertedBitmap, 0, 0);
    }
  }, 2000);

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <br> <button onclick="renderIframe(this,'3jldX','uZ2hI')">Run</button>
  <div id="uZ2hI_FloatingLog" class="floatingLog" aria-live="polite" role="alert"></div> <iframe id="uZ2hI" class="result_iframe" style="display: none;"></iframe>
  <script>
			{
				let editor = CodeMirror.fromTextArea(document
						.getElementById("3jldX"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    const mode = localStorage.getItem("mode") || "light";  
			    const newTheme = mode === "dark" ? "material" : "default";
			    editor.setOption("theme", newTheme);
			    
				codeMirrorMap.set("3jldX", editor);

				let editor1 = CodeMirror.fromTextArea(document.getElementById("3jldX_Textarea"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    editor1.setOption("theme", newTheme);				
				
				codeMirrorMap.set("3jldX_Textarea", editor1);
			}
		    function openDialog(id) {
		        closeAll();
		        document.getElementById(id).style.display = 'flex';
		        setTimeout(() => {
		        	 codeMirrorMap.get("3jldX_Textarea").refresh();
		        }, 100); // 100ms 
		      }

		      function closeAll() {
		        document.querySelectorAll('.dialog-backdrop').forEach(el => {
		          el.style.display = 'none';
		        });
		      }			
		</script>
 </div>
</div><h3 id="summary">Summary</h3><p>Using <code>OffscreenCanvas</code> is a powerful technique for:</p><ul>
 <li>Improving performance by offloading expensive drawing or filtering tasks.</li>
 <li>Keeping the UI responsive during complex canvas operations.</li>
 <li>Preparing and caching visual content before rendering it on screen.</li>
</ul><p>As browser support grows, this API will become an essential tool for advanced canvas programming and smooth user experiences.</p><p>Next, we will combine these techniques in a practical example that applies grayscale and invert filters efficiently.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='javascript-canvas-programming.htm#working-with-pixel-data-and-filters' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='practical-example-grayscale-and-invert-color-filters'>11.4 Practical Example: Grayscale and Invert Color Filters</h2><p>In this section, we'll build a simple but interactive image processor that allows you to switch between the original image, a grayscale version, and an inverted color version. This hands-on example will help you practice using <code>getImageData()</code> and <code>putImageData()</code> for pixel manipulation and understand how to efficiently apply filters based on user input.</p><h3 id="step-1-setting-up-the-canvas-and-image">Step 1: Setting Up the Canvas and Image</h3><p>First, create an HTML structure with a canvas, buttons to switch filters, and an image loaded onto the canvas:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-html">&lt;canvas id="canvas" width="400" height="300"&gt;&lt;/canvas&gt;
&lt;br /&gt;
&lt;button id="originalBtn"&gt;Original&lt;/button&gt;
&lt;button id="grayscaleBtn"&gt;Grayscale&lt;/button&gt;
&lt;button id="invertBtn"&gt;Invert Colors&lt;/button&gt;</code></pre>
</div><p>In your JavaScript, load an image and draw it onto the canvas:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const img = new Image();

img.src = 'your-image.jpg'; // Use any image URL or local path
img.onload = () =&gt; {
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
};</code></pre>
</div><h3 id="step-2-accessing-and-storing-image-data">Step 2: Accessing and Storing Image Data</h3><p>We’ll keep a copy of the original image data so we can revert or apply filters from the base image:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">let originalImageData = null;

img.onload = () =&gt; {
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
};</code></pre>
</div><h3 id="step-3-creating-the-filter-functions">Step 3: Creating the Filter Functions</h3><h4 id="grayscale-filter">Grayscale Filter</h4><p>To convert to grayscale, average the red, green, and blue components for each pixel and assign that value back to all three channels:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">function applyGrayscale(imageData) {
  const data = imageData.data;
  for (let i = 0; i &lt; data.length; i += 4) {
    const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
    data[i] = data[i + 1] = data[i + 2] = avg;
  }
  return imageData;
}</code></pre>
</div><h4 id="invert-colors-filter">Invert Colors Filter</h4><p>Invert colors by subtracting each color component from 255:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">function applyInvert(imageData) {
  const data = imageData.data;
  for (let i = 0; i &lt; data.length; i += 4) {
    data[i] = 255 - data[i];     // Red
    data[i + 1] = 255 - data[i + 1]; // Green
    data[i + 2] = 255 - data[i + 2]; // Blue
  }
  return imageData;
}</code></pre>
</div><h3 id="step-4-handling-button-clicks-to-switch-filters">Step 4: Handling Button Clicks to Switch Filters</h3><p>Add event listeners to the buttons to apply the selected filter and update the canvas:</p><div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-js">document.getElementById('originalBtn').addEventListener('click', () =&gt; {
  if (originalImageData) {
    ctx.putImageData(originalImageData, 0, 0);
  }
});

document.getElementById('grayscaleBtn').addEventListener('click', () =&gt; {
  if (originalImageData) {
    // Create a copy to avoid modifying original data
    const imageDataCopy = new ImageData(
      new Uint8ClampedArray(originalImageData.data),
      originalImageData.width,
      originalImageData.height
    );
    ctx.putImageData(applyGrayscale(imageDataCopy), 0, 0);
  }
});

document.getElementById('invertBtn').addEventListener('click', () =&gt; {
  if (originalImageData) {
    const imageDataCopy = new ImageData(
      new Uint8ClampedArray(originalImageData.data),
      originalImageData.width,
      originalImageData.height
    );
    ctx.putImageData(applyInvert(imageDataCopy), 0, 0);
  }
});</code></pre>
</div><div class="snippet-container" id="AeAY8">
 <div id="1eVpL_Dialog" class="dialog-backdrop">
  <div class="dialog">
   <h2>Dialog 1</h2>
   <div class="controls"><button onclick="renderIframe(this,'X2tRy_Textarea','1eVpL_IFrame')">Run</button> <button onclick="closeAll()">Close</button>
   </div>
   <div class="dialog-content"><textarea id="X2tRy_Textarea" class="textarea_dialog" placeholder="Type HTML here...">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8" /&gt;
  &lt;title&gt;Canvas Image Filters&lt;/title&gt;
  &lt;style&gt;
    canvas {
      border: 1px solid #ccc;
      display: block;
      margin-bottom: 10px;
    }
    button {
      margin-right: 5px;
      padding: 5px 10px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;canvas id="canvas" width="400" height="300"&gt;&lt;/canvas&gt;
&lt;br /&gt;
&lt;button id="originalBtn"&gt;Original&lt;/button&gt;
&lt;button id="grayscaleBtn"&gt;Grayscale&lt;/button&gt;
&lt;button id="invertBtn"&gt;Invert Colors&lt;/button&gt;

&lt;script&gt;
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const img = new Image();

  // Use a sample image URL (CORS-enabled)
  img.crossOrigin = "anonymous";
  img.src = 'https://readbytes.github.io/60x60/1.png';

  let originalImageData = null;

  img.onload = () =&gt; {
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
  };

  function applyGrayscale(imageData) {
    const data = imageData.data;
    for (let i = 0; i &lt; data.length; i += 4) {
      const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
      data[i] = data[i + 1] = data[i + 2] = avg;
    }
    return imageData;
  }

  function applyInvert(imageData) {
    const data = imageData.data;
    for (let i = 0; i &lt; data.length; i += 4) {
      data[i] = 255 - data[i];       // Red
      data[i + 1] = 255 - data[i + 1]; // Green
      data[i + 2] = 255 - data[i + 2]; // Blue
    }
    return imageData;
  }

  document.getElementById('originalBtn').addEventListener('click', () =&gt; {
    if (originalImageData) {
      ctx.putImageData(originalImageData, 0, 0);
    }
  });

  document.getElementById('grayscaleBtn').addEventListener('click', () =&gt; {
    if (originalImageData) {
      const imageDataCopy = new ImageData(
        new Uint8ClampedArray(originalImageData.data),
        originalImageData.width,
        originalImageData.height
      );
      ctx.putImageData(applyGrayscale(imageDataCopy), 0, 0);
    }
  });

  document.getElementById('invertBtn').addEventListener('click', () =&gt; {
    if (originalImageData) {
      const imageDataCopy = new ImageData(
        new Uint8ClampedArray(originalImageData.data),
        originalImageData.width,
        originalImageData.height
      );
      ctx.putImageData(applyInvert(imageDataCopy), 0, 0);
    }
  });
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <iframe id="1eVpL_IFrame" class="iframe_dialog"></iframe>
   </div>
  </div>
 </div>
 <div class="snippet-header" onclick="toggleSnippetAndRefresh('AeAY8','X2tRy')">
  Click to Try it <!--<span onclick="toggleSnippetAndRefresh('AeAY8','X2tRy')">Click
			to Try it</span> --> <!-- <span onclick="openDialog('1eVpL_Dialog')">Dialog</span> -->
 </div>
 <div class="snippet-body"><textarea id="X2tRy">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8" /&gt;
  &lt;title&gt;Canvas Image Filters&lt;/title&gt;
  &lt;style&gt;
    canvas {
      border: 1px solid #ccc;
      display: block;
      margin-bottom: 10px;
    }
    button {
      margin-right: 5px;
      padding: 5px 10px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;canvas id="canvas" width="400" height="300"&gt;&lt;/canvas&gt;
&lt;br /&gt;
&lt;button id="originalBtn"&gt;Original&lt;/button&gt;
&lt;button id="grayscaleBtn"&gt;Grayscale&lt;/button&gt;
&lt;button id="invertBtn"&gt;Invert Colors&lt;/button&gt;

&lt;script&gt;
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const img = new Image();

  // Use a sample image URL (CORS-enabled)
  img.crossOrigin = "anonymous";
  img.src = 'https://readbytes.github.io/60x60/1.png';

  let originalImageData = null;

  img.onload = () =&gt; {
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
  };

  function applyGrayscale(imageData) {
    const data = imageData.data;
    for (let i = 0; i &lt; data.length; i += 4) {
      const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
      data[i] = data[i + 1] = data[i + 2] = avg;
    }
    return imageData;
  }

  function applyInvert(imageData) {
    const data = imageData.data;
    for (let i = 0; i &lt; data.length; i += 4) {
      data[i] = 255 - data[i];       // Red
      data[i + 1] = 255 - data[i + 1]; // Green
      data[i + 2] = 255 - data[i + 2]; // Blue
    }
    return imageData;
  }

  document.getElementById('originalBtn').addEventListener('click', () =&gt; {
    if (originalImageData) {
      ctx.putImageData(originalImageData, 0, 0);
    }
  });

  document.getElementById('grayscaleBtn').addEventListener('click', () =&gt; {
    if (originalImageData) {
      const imageDataCopy = new ImageData(
        new Uint8ClampedArray(originalImageData.data),
        originalImageData.width,
        originalImageData.height
      );
      ctx.putImageData(applyGrayscale(imageDataCopy), 0, 0);
    }
  });

  document.getElementById('invertBtn').addEventListener('click', () =&gt; {
    if (originalImageData) {
      const imageDataCopy = new ImageData(
        new Uint8ClampedArray(originalImageData.data),
        originalImageData.width,
        originalImageData.height
      );
      ctx.putImageData(applyInvert(imageDataCopy), 0, 0);
    }
  });
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</textarea> <br> <button onclick="renderIframe(this,'X2tRy','1eVpL')">Run</button>
  <div id="1eVpL_FloatingLog" class="floatingLog" aria-live="polite" role="alert"></div> <iframe id="1eVpL" class="result_iframe" style="display: none;"></iframe>
  <script>
			{
				let editor = CodeMirror.fromTextArea(document
						.getElementById("X2tRy"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    const mode = localStorage.getItem("mode") || "light";  
			    const newTheme = mode === "dark" ? "material" : "default";
			    editor.setOption("theme", newTheme);
			    
				codeMirrorMap.set("X2tRy", editor);

				let editor1 = CodeMirror.fromTextArea(document.getElementById("X2tRy_Textarea"), {
					mode : "htmlmixed",
					lineNumbers : false,
					tabSize : 2
				});
			    editor1.setOption("theme", newTheme);				
				
				codeMirrorMap.set("X2tRy_Textarea", editor1);
			}
		    function openDialog(id) {
		        closeAll();
		        document.getElementById(id).style.display = 'flex';
		        setTimeout(() => {
		        	 codeMirrorMap.get("X2tRy_Textarea").refresh();
		        }, 100); // 100ms 
		      }

		      function closeAll() {
		        document.querySelectorAll('.dialog-backdrop').forEach(el => {
		          el.style.display = 'none';
		        });
		      }			
		</script>
 </div>
</div><h3 id="step-5-optimizations-and-enhancements">Step 5: Optimizations and Enhancements</h3><ul>
 <li><p><strong>Efficient Looping:</strong> The loops increment by 4 because each pixel consists of 4 values (Red, Green, Blue, Alpha). This is the most efficient way to iterate pixels.</p></li>
 <li><p><strong>Selective Filtering:</strong> You can extend the functions to apply filters only within a selected rectangular region or on mouse hover by limiting the loop to the corresponding pixel indices.</p></li>
 <li><p><strong>Modular Design:</strong> The filter functions take and return an <code>ImageData</code> object, making it easy to combine filters or build pipelines.</p></li>
</ul><h3 id="summary">Summary</h3><p>This example combines key canvas pixel manipulation techniques:</p><ul>
 <li>Using <code>getImageData()</code> to access raw pixel RGBA data.</li>
 <li>Processing pixels efficiently with loops.</li>
 <li>Applying filters like grayscale and invert by modifying color values.</li>
 <li>Using <code>putImageData()</code> to update the canvas display.</li>
 <li>Keeping the original image data intact for toggling filters seamlessly.</li>
</ul><p>Try extending this project by adding sliders for brightness or contrast, or implementing additional filters like sepia or blur. Experiment with applying filters dynamically on mouse movement or selecting parts of the image to edit!</p><div class = "chapter-navi-section">
<a href="javascript-canvas-programming-working-with-canvas-state-and-compositing.htm" class="nav-button prev">←</a>
<a href='javascript-canvas-programming.htm#working-with-pixel-data-and-filters' class="nav-button toc-link">Index</a>
<a href="javascript-canvas-programming-3d-effects-and-webgl-basics.htm" class="nav-button next">→</a>
</div>
<section class="download-section">
  <div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 16px;color: #333;top: 10px;">JavaScript Canvas Programming</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 80px;height: 80px;top: 70px;" src='data:image/png;base64,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'/>
  </div>
  <div class="download-info">
    <h2 id='bottom'>Download This Ebook</h2>
    <p class="format-label">Available formats:</p>
    <div class="download-buttons">
      <a href="javascript-canvas-programming.pdf" class="download-button">📄 PDF</a>
      <a href="javascript-canvas-programming.epub" class="download-button">📘 EPUB</a>
    </div>
  </div>
</section><div class='related-books'>
<h2>Javascript Web Front Books</h2>
<div class='related-book-list'>
<a href="javascript-canvas-programming.htm">
<div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 16px;color: #333;top: 10px;">JavaScript Canvas Programming</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 80px;height: 80px;top: 70px;" src='data:image/png;base64,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'/>
  </div>
</a>


<a href="javascript-dom-programming.htm">
<div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 16px;color: #333;top: 20px;">JavaScript DOM Programming</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 90px;height: 90px;top: 60px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAADUklEQVR4Xu2dv47TQBDGI0RDczY9rwMlrwEFBweC/t4EXRwaXuI6WiSaOLkCIZ6BCqTgPRFr8zkbnPF4Zuydn/RVuzsz33eSlX/2LRYRm1Xxe1MVOzY19eL6/6NzfqCw/ilEvXc2Mwh7pNiuyks8O1T1snyNfVLgWQ5hjxbcyCHskaJelVd4drCW5Vvsk6JzlkHYo6XXph5Q6hwEfUZASDhLqUOZ+Ri96vTa1ANKHQ+aAKWOB02AUseDJkCp40EToNTxoAlQ6njQBCh1PGgClDrZBs0l7JEi23eGXMIeKTbVxSs8O1Trm4tL7JMCz3IIe7Rsq+IXbh6iUA97nALPDxXWP4W29w5xMVwbG67rOBVR76LNAA9aiKyCbq49L0QbRmgGHXuul8VLXB+F3IPGtdGIm0o21gpay+89Gs01gtbwecDPz08eSQ8hHTT6C55xjwh3q+IZDhO0u148wL0cSAR93cyOfoKCV9wryu528RCHmpuCR/StRvOy7w8OOHUFT+jTDHdV+RwHnpqCB/SVFRLXaGfhQYvhQQvhQQvhQQvhQf8DXyZNXehPnW+fisc45FwUvKFfNXC4uQn9qvD1Y1maG4qB2NP3xiOui1NX5Zv9QNuq+IDrU6Xx8n7vq16WV7guTvxKYH1TvsP1qWLOl7mBmDDny9xATJjzZW4gJsz5MjcQE+Z8mRuICXO+zA3EhDlf5gZiwpwvcwMxYc6XuYGYMOfL3EBMmPNlbiAmzPkyNxAT5nyZG4gJc778Y1Ih/IN/QeKh5ij0q8acv5z9YenL2T045NSF/rIhfiWQ9Q9oxsaDFsKDFsKDFsKDFsKDjqj9ZqFx8dvfRubWb+gcn+Yv/hSHuh9swrcoh9nRT5DaLcpf/KZ7GXAIXB8D6aADGj5btJprBB3Q8nvQGNfGRCvogLjntT+8SubhVVohBzSDDoh6F20GeNBCzCZo7Qeh4vmhwvqnEPWOmzmEPVJk9Vhj3Mgh7JHi4LLApTMuL52zDMIeLb029YBSh+v6G85S6lBmPkavOr029YBSx4MmQKnjQROg1PGgCVDqeNAEKHU8aAKUOh40AUodD5oApU62QXMJe6TI9p0hl7BHitz+XTX3j2DO+gHKkfODhPVPsRnZ+1+tJg8Iaaje6wAAAABJRU5ErkJggg=="/>
  </div>
</a>


<a href="javascript-data-visualization.htm">
<div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 16px;color: #333;top: 20px;">JavaScript Data Visualization</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 90px;height: 90px;top: 60px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAC0UlEQVR4Xu3dMWsUURSG4fwr2U6zJI0WKZSAaa0EG7tU2giWimLETrQQQRCxUDsbK3+IYOWCiFU06IQz356ZuffOvXdm4A28ze585OxDsLDZnR3zs1pf+rHavXhKWdpY2/Mf50HKEMgV+4cs/1z8/v6OMiTYm9Zfsz5M42r9VQNdLqArBXSlgK4U0JUCulKLgrb39aW7ObQY6PXl/S3Qrs6e1f3ULQZaMYfS/dTZ2xYDvff6g9tS7ge6YEBXCuhKAV0poCsFdKWArtQk0G9e3Tt9dnLc2+dPD1sboCOzv2Ool8/vujsFBtpJMYfydgoMtFMqWOpuLtnbgC6YvQ3ogtnbgC6YvQ3ogtnbgC6YvQ3ogtnbgC6YvQ3ogtnboqCvHR20xn11/UKF6gNL3Y1JP0dXV68fbG01+3wUtP6yvp4+OXZ3CtUHlrpL7ew/tvRz9KV7zT4LtGmW0O+/fnRr3l86tH4u/Xwhv88+C7QJ6MhdakBH7lIDOnKXGtCRu9SAjtylBnTkLjWgI3e67evnt7fnG6BH7EJqdkCP2IXU7IAesft169DN2wE9YqfAQDt35NgpMNDOHTl2Cgy0c0eOnQID7dxhXwvJ2ykw0M4d9rWQvJ0CA+3cYV8LydspMNDOHfa1C/cfuQ3tFBho5w77mgID/f99oCeGDsnbKXBp6JDUR7PPAm12QO8CvVXzfhe0QoWC6fOhOwUOhX7w4rGbt+vKPgu02QE9YqfAi4Meai7QITU7oEfsQmp2s4S+cfumW/P+XKDvXFm7ebtZQusBeshcoL8c7rt5O6BH7BQYaOeOHDsFBtq5I8dOgYF27sixU2CgnTty7BQYaOeOHDsFBtq5I8dOgRcHPVQXdEhT7Wb536RDAQ30Vs1uNtAUF9CVArpSQFcK6EoBXSmgK9WG5qtQi2RNV803KsuLlDn7RcpgF6qF3Pz8fWOjD1JyrS9g/wOlHj3Oru4PcQAAAABJRU5ErkJggg=="/>
  </div>
</a>


<a href="jquery-in-depth.htm">
<div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 18px;color: #333;top: 20px;">jQuery In-Depth</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 90px;height: 90px;top: 65px;" src='data:image/png;base64,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'/>
  </div>
</a>



<a href='javascript.htm'><div class='book-cover' style='background-color: #f9f6f1;color: #111111;border: 1px solid #ccc;display: flex;justify-content: center;align-items: center;text-align: center;'>More Javascript Books</div></a>
</div>
</div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  
  <script>
    function copyCode(button) {
      const code = button.nextElementSibling.innerText;
      navigator.clipboard.writeText(code).then(() => {
        button.textContent = 'Copied!';
        setTimeout(() => { button.textContent = 'Copy'; }, 1500);
      });
    }
  </script>  
<div id="floatingLog" aria-live="polite" role="alert"></div>
<footer class="page-footer">
    <nav>
      <a href="https://readbytes.github.io">Home</a> | 
      Email:<script language="JavaScript" type="text/javascript">
var part1 = 'yinpeng';var part6 = '263';var part2 = Math.pow(2,6);var part3 = String.fromCharCode(part2);var part4 = 'hotmail dot com';var part5 = part1 + String.fromCharCode(part2) + part4;document.write(part1 + part6 + part3 + part4);
</script>
    </nav>
  <p>© 2025 — All rights reserved.</p>    
  </footer>

</body>
</html>