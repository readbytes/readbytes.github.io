<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pandas for Data Science Advanced Indexing and MultiIndex</title>
<link rel='shortcut icon' href='https://readbytes.github.io/images/favicon.ico'>
<link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css"><style>
html {scroll-behavior: smooth;}  
body {font-family: 'Merriweather', serif;;margin: 0;padding: 2rem 1rem;font-size: 15px;line-height: 1.5;transition: background-color 0.3s, color 0.3s;}
.container {max-width: 750px;margin: 0 auto;padding: 1rem 2rem;}
.light-mode {background-color: #f8f7f5;color: #333;} 
.dark-mode {background-color: #121212;color: #e0e0e0;}
a { text-decoration: none;transition: color 0.2s;}
a:hover {text-decoration: underline;}
.light-mode a {color: #555;}
.dark-mode a {color: #aaa;}
</style><style>
.related-book-list {display: flex;flex-wrap: wrap;gap: 20px;}
.related-books {margin-top: 40px;}
.related-books h2 {font-size: 22px;margin-bottom: 20px;border-bottom: 2px solid #eee;padding-bottom: 8px;}
.light-mode .related-books h2 {color: #333;border-color: #eee;}
.dark-mode .related-books h2 {color: #ddd;border-color: #333;}
</style><style>
.book-cover {width: 130px;height: 180px;font-family: Arial, sans-serif;position: relative;overflow: hidden;box-shadow: 2px 2px 4px rgba(0,0,0,0.1);}
.book-cover-bottom-stripe {position: absolute;bottom: 0;left: 0;height: 5px;width: 100%;}
.book-cover-title {position: absolute;width: 100%;text-align: center;font-weight: bold;}
.book-cover-icon {position: absolute;left: 50%;transform: translateX(-50%);display: flex;align-items: center;justify-content: center;}
.book-cover-author {position: absolute;bottom: 10px;width: 100%;text-align: center;font-size: 8px;color: #333;}
</style><style>
.book-title-toc {font-size: 32px;font-weight: bold; }
.book-subtitle-toc {font-size: 18px;margin-top: 8px;font-style: italic;}
.book-header {text-align: center;margin-bottom: 40px;}

.toc-container {border-radius: 10px;padding: 30px;margin-bottom: 40px;box-shadow: 0 8px 20px rgba(0,0,0,0.05);}
h1 {font-size: 24px;text-align: center;margin-bottom: 30px;letter-spacing: 1px;padding-bottom: 10px;}
.toc-list,.toc-section-list {list-style: none;padding: 0;margin: 0;}
.toc-section-list {padding-left: 18px;margin-top: 6px;margin-bottom: 20px; }
.toc-chapter {padding: 20px 0;}
.chapter-title,.toc-section {display: flex;justify-content: space-between;padding-top: 4px;}
.chapter-title {font-size: 17px;font-weight: bold;}
.chapter-page,.section-page {font-style: italic;}
 
 
.light-mode .book-title-toc,.light-mode .chapter-title,.light-mode .book-name {color: #222;}
.light-mode .book-subtitle-toc,.light-mode .book-sub,.light-mode .chapter-page,.light-mode .section-page {color: #666;}
.light-mode .toc-container { background: #fff;border: 1px solid #ddd;}
.light-mode h1 {border-bottom: 2px solid #eee;color: #222;}
.light-mode .toc-section {  color: #444;}

.light-mode .book-cover { border: 1px solid #ccc;box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);}
.light-mode .book-title,.light-mode .series-name {color: #fff;}
.light-mode .book-subtitle,.light-mode .book-footer {color: #aaa;}

.dark-mode .book-title-toc,.dark-mode .chapter-title,.dark-mode .book-name {color: #f5f5f5;}
.dark-mode .book-subtitle-toc,.dark-mode .book-sub,.dark-mode .chapter-page,.dark-mode .section-page {color: #aaa;}
.dark-mode .toc-container {background: #1e1e1e;border: 1px solid #444;}

.dark-mode h1 {border-bottom: 2px solid #333;color: #eee;}
.dark-mode .toc-section {color: #bbb;}

.dark-mode .related-books h2 {color: #ddd;border-bottom: 2px solid #333;}
.dark-mode .book-title,.dark-mode .series-name {color: #fff;}
.dark-mode .book-subtitle,.dark-mode .book-footer {color: #bbb;}
.dark-mode .toc-section {color: #ddd;}

@media (max-width: 600px) {
  .chapter-title,
  .toc-section {
    flex-direction: column;
    align-items: flex-start;
  }

  .chapter-page,
  .section-page {
    margin-top: 4px;
  }
}

</style><style>
.light-mode .container {box-shadow: 0 0 15px rgba(0,0,0,0.1);}
.dark-mode .container {box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);}

h1, h2, h3 {font-weight: 600;margin-top: 2.5rem;margin-bottom: 1rem;line-height: 1.2;}
h1 { font-size: 1.8rem; }
h2 { font-size: 1.4rem; }
h3 { font-size: 1.2rem; }

table {width: 100%;border-collapse: collapse;font-family: sans-serif;font-size: 1em;margin: 1em 0;}
th, td {padding: 0.6em 1em;text-align: left;border: 1px solid;}
tr:nth-child(even) {  background-color: inherit;}
tr:hover { background-color: inherit;}

code {color: #d35400;}

.chapter-navi-section {display: flex;justify-content: space-between;align-items: center;padding-bottom: 10px;padding-top: 10px;}
.nav-link {color: inherit;text-decoration: none;opacity: 0.5;transition: opacity 0.3s ease, text-decoration 0.3s ease;}
.nav-link:hover {opacity: 0.9;text-decoration: underline;}
.prev { text-align: left; }
.toc-link { text-align: center; }
.next { text-align: right; }

.download-section {display: flex;align-items: center;justify-content: center;gap: 2rem;padding: 2rem 1rem;max-width: 600px;margin: 3rem auto;border-radius: 12px;box-shadow: 0 4px 10px rgba(0,0,0,0.05);}
.download-info h2 {margin: 0 0 0.5rem;font-size: 1.2rem;}
.format-label {margin: 0 0 0.5rem;font-size: 0.95rem;}
.download-buttons {display: flex;gap: 1rem;}
.download-button {background-color: #4A90E2;color: white;padding: 0.5em 1.2em;border-radius: 25px;font-size: 0.95rem;text-decoration: none;transition: background-color 0.3s ease;}
.download-button:hover {background-color: #357ABD;}

.code-block {position: relative;margin-bottom: 1em;}
.copy-button {background: transparent;color: white;position: absolute;top: 8px;right: 8px;border: none;padding: 4px 8px;font-size: 12px;border-radius: 4px;cursor: pointer;z-index: 1;}
.copy-button:hover {background-color: #0056b3;}

.snippet-container {overflow: hidden;}
.snippet-header {padding: 0.75rem 1rem;cursor: pointer;font-size: 1rem;background-color: #eeeeee;color:  #111111; border-radius: 8px;cursor: pointer;box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
.snippet-body {display: none;font-family: monospace;}
.snippet-container.open .snippet-body {display: block;}

.CodeMirror {border: 2px solid #ccc;border-radius: 4px;resize: vertical;}

.light-mode .format-label {color: #888;}
.light-mode th {background-color: #f2f2f2;}
.light-mode tr:nth-child(even) {background-color: #fafafa;}
.light-mode tr:hover {background-color: #e6f7ff;}

.dark-mode .snippet-header {background-color: #333;color:  #ddd; }
.dark-mode .format-label {color: #aaa;}
.dark-mode th {background-color: #333;color: #fff;}
.dark-mode td {border-color: #444;}
.dark-mode tr:nth-child(even) {background-color: #2a2a2a;}
.dark-mode tr:hover {background-color: #2c3e50;}


.button-group-run-edit {display: flex;width: 100%;gap: 1rem;}
.button-run-edit {flex: 1;padding: 1rem;font-size: 1rem;font-weight: 600;border: none;border-radius: 8px;cursor: pointer;transition: background 0.3s, color 0.3s;}

.light-mode .button-run-edit {background-color: #f0f0f0;color: #222;box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);}
.light-mode .button-run-edit:hover {background-color: #e0e0e0;}

.dark-mode .button-run-edit {background-color: #2a2a2a;color: #f5f5f5;box-shadow: 0 0 10px rgba(255, 255, 255, 0.05);}
.dark-mode .button-run-edit:hover {background-color: #3a3a3a;}

button { padding: 0.5em 1em; background: green; color: white; border: none; cursor: pointer; }
button:hover { background: #1e7e34; }
.result_iframe { width:99%; margin-top: 1em;  resize: both;background-color: #515b63;border:1px solid #ccc;}   

.dialog-backdrop {position: fixed;top: 0;left: 0;width: 100vw;height: 100vh;background: rgba(0,0,0,0.5);display: none;justify-content: center;align-items: center;z-index: 10;}
.dialog {background: #90979e;padding: 20px;width: 90vw;height: 80vh;border-radius: 8px;box-shadow: 0 0 20px rgba(0,0,0,0.3);display: flex;flex-direction: column;}
.dialog-content {display: flex;gap: 20px;margin-top: 10px;height: calc(100% - 40px);}
.editor-container, .preview-container {flex: 1;height: 100%;max-height: 100%;overflow: hidden; }
.result_iframe_dialog {width: 100%;height: 100%;resize: both;border:1px solid #ccc;overflow: auto; }   
.CodeMirror {width: 100% !important;height: 100% !important;}
</style><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
<script>
const pythonCodeMirrorMap = new Map();
let pyodide = null;
let pyodideReady = false;
async function main() {
    pyodide = await loadPyodide();
    await pyodide.loadPackage(['numpy','pandas','matplotlib']);
    pyodideReady = true;
}
main();

 async function runPythonCode(button,textarea_id, iframe_id) {
        let code = pythonCodeMirrorMap.get(textarea_id).getValue();
        const iframe = document.getElementById(iframe_id);
        let doc = iframe.contentDocument || iframe.contentWindow.document;
 
        let result = "";

    if (!pyodideReady) {
      result = "Pyodide is still loading... Wait for a while and click Run again.";
    }else{
    try {
      await pyodide.runPythonAsync(`
import sys
from js import console

class CaptureOutput:
    def __init__(self):
        self.data = []
    def write(self, msg):
        self.data.append(msg)
    def flush(self):
        pass

sys.stdout = sys.stderr = capture = CaptureOutput()

${code}

output = "".join(capture.data)
`);
      result = pyodide.globals.get('output');
 
      
    } catch (err) {
      result = "Error:\n" + err;
 
    }
    }

 

      const html = `
    <!DOCTYPE html>
    <html>
      <head>
        <title>Output</title>
        <style>
          body { font-family: monospace; padding: 1em; background: #1e1e1e; color: #eee; }
          pre { white-space: pre-wrap; word-break: break-word; }
          .error { color: red; }
        </style>
      </head>
      <body>
        <pre id="log">${result} </pre>
      </body>
    </html>
  `;
        iframe.style.display = "block";
        iframe.srcdoc = html;  
        

iframe.onload = function () {
  const doc = iframe.contentDocument || iframe.contentWindow.document;
  const contentHeight = Math.max(
    doc.body.scrollHeight,
    doc.documentElement.scrollHeight
  );
  iframe.style.height = contentHeight + 'px';
};

    }
function openEditPythonCodeDialog(id, textarea_id) {
		        closeAllPythonCodeDialog();
		        document.getElementById(id).style.display = 'flex';
         
 	        setTimeout(() => {
		        	 pythonCodeMirrorMap.get(textarea_id).refresh();
                   
 	        }, 100); // 100ms 
}

function closeAllPythonCodeDialog() {
		        document.querySelectorAll('.dialog-backdrop').forEach(el => {
		          el.style.display = 'none';
		        });
}		
</script>
</head>
<body>
<script>const mode = localStorage.getItem('mode') || 'light';document.documentElement.classList.add(`${mode}-mode`);</script>  
<div class="container"><div class = "chapter-navi-section">
<a href="pandas-for-data-science-performance-optimization-and-best-practices.htm" class="nav-button prev">←</a>
<a href='pandas-for-data-science.htm#advanced-indexing-and-multiindex' class="nav-button toc-link">Index</a>
<a href="pandas-for-data-science-customizing-pandas-with-extensions-and-apis.htm" class="nav-button next">→</a>
</div>
<div class='book-header'><h1 class='book-title-toc' id = 'top'>Advanced Indexing and MultiIndex</h1><h3 class='book-subtitle-toc'>Pandas for Data Science</h3></div><h2 id='creating-and-using-multiindex-dataframes'>13.1 Creating and Using MultiIndex DataFrames</h2><p>Pandas’ <strong>MultiIndex</strong> (also known as hierarchical indexing) is a powerful feature that allows you to represent higher-dimensional data within a two-dimensional <code>DataFrame</code>. Rather than relying on a single index column, MultiIndex allows for <strong>multiple levels of indexing</strong>, both on rows and columns. This structure is especially helpful in fields like finance, sensor analytics, and survey data—where data is often naturally hierarchical.</p><h3 id="why-use-multiindex">Why Use MultiIndex?</h3><p>MultiIndex provides a way to:</p><ul>
 <li>Efficiently store and query <strong>grouped or nested data</strong></li>
 <li>Represent data in <strong>panel or 3D-like form</strong> without increasing dimensionality</li>
 <li>Simplify <strong>grouped operations</strong>, aggregations, and reshaping</li>
</ul><p>However, this power comes with some complexity: MultiIndexed DataFrames can be harder to manipulate and visualize at first glance.</p><h3 id="creating-a-multiindex">Creating a MultiIndex</h3><p>There are several ways to create a MultiIndex:</p><h4 id="from-tuples">From Tuples</h4><p>You can define hierarchical keys using a list of tuples:</p><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import pandas as pd

index = [('North', 2023), ('North', 2024),
         ('South', 2023), ('South', 2024)]
multi_idx = pd.MultiIndex.from_tuples(index, names=['Region', 'Year'])

data = [100, 120, 90, 110]
df = pd.DataFrame(data, index=multi_idx, columns=['Sales'])

print(df)</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'fr4wA','gWBFa')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('gWBFa_Dialog','fr4wA')">Edit</button>
  </div> <iframe id="gWBFa" class="result_iframe" style="display: none;"></iframe>
  <div id="gWBFa_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'fr4wA','gWBFa_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="fr4wA" class="textarea_dialog" placeholder="Type HTML here...">import pandas as pd

index = [('North', 2023), ('North', 2024),
         ('South', 2023), ('South', 2024)]
multi_idx = pd.MultiIndex.from_tuples(index, names=['Region', 'Year'])

data = [100, 120, 90, 110]
df = pd.DataFrame(data, index=multi_idx, columns=['Sales'])

print(df)</textarea>
     </div>
     <div class="preview-container">
      <iframe id="gWBFa_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("fr4wA"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("fr4wA", editor);

}


</script>
 </div>
</div><p><strong>Output:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-bash">Sales
Region Year       
North  2023    100
       2024    120
South  2023     90
       2024    110</code></pre>
</div><p>Here, <code>Region</code> and <code>Year</code> are index levels. This structure lets you access or slice data in more flexible ways.</p><h4 id="from-arrays">From Arrays</h4><p>You can also create a MultiIndex from separate lists or arrays:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">regions = ['East', 'East', 'West', 'West']
years = [2023, 2024, 2023, 2024]

multi_idx = pd.MultiIndex.from_arrays([regions, years], names=['Region', 'Year'])
df = pd.DataFrame({'Profit': [30, 50, 40, 60]}, index=multi_idx)

print(df)</code></pre>
</div><h4 id="from-existing-dataframe-with-set-index">From Existing DataFrame with <code>set_index()</code></h4><p>Another common method is to convert columns into a MultiIndex:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">data = {
    'Region': ['North', 'North', 'South', 'South'],
    'Year': [2023, 2024, 2023, 2024],
    'Sales': [200, 220, 180, 190]
}

df = pd.DataFrame(data)
df = df.set_index(['Region', 'Year'])

print(df)</code></pre>
</div><p>This method is useful when importing structured data from external sources and transforming it for analysis.</p><h3 id="inspecting-and-navigating-multiindex">Inspecting and Navigating MultiIndex</h3><p>You can explore and manipulate the index with:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df.index.levels         # Show unique values in each level
df.index.names          # Index level names
df.loc['North']         # All years for 'North'
df.loc[('South', 2023)] # Specific selection</code></pre>
</div><p>You can also reset the index:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df_reset = df.reset_index()</code></pre>
</div><p>This will flatten the hierarchy back into columns.</p><h3 id="benefits-of-multiindex">Benefits of MultiIndex</h3><ul>
 <li><strong>Compact storage</strong> for grouped data</li>
 <li>Supports complex <strong>groupby</strong> operations</li>
 <li>Enables <strong>reshaping</strong> with <code>.unstack()</code> and <code>.stack()</code></li>
</ul><h3 id="trade-offs">Trade-Offs</h3><ul>
 <li>More complex to slice and filter than flat indices</li>
 <li>Certain operations may behave differently or require more syntax</li>
 <li>Not always optimal for small/simple datasets</li>
</ul><h3 id="summary">Summary</h3><p>The MultiIndex structure in pandas is a foundational tool for managing hierarchical or grouped data within a 2D frame. Whether you’re organizing sales across regions and years, comparing experiments across test conditions, or analyzing panel data, MultiIndex allows you to preserve the dimensionality of your data while enabling powerful operations and aggregations.</p><p>In the next section, you'll learn how to <strong>slice and select</strong> data within a MultiIndex using intuitive and advanced methods.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='pandas-for-data-science.htm#advanced-indexing-and-multiindex' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='index-slicing-and-advanced-selections'>13.2 Index Slicing and Advanced Selections</h2><p>Once you’ve created a <code>MultiIndex</code> DataFrame, the next step is learning how to access and manipulate its data efficiently. This section explores several powerful techniques: accessing data using <code>.loc[]</code> with tuples and slices, using the <code>.xs()</code> (cross-section) method, and performing partial and boolean selections.</p><h3 id="accessing-with-loc-and-tuples">Accessing with <code>.loc[]</code> and Tuples</h3><p>In MultiIndex DataFrames, you use <strong>tuples</strong> in <code>.loc[]</code> to refer to specific index combinations:</p><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import pandas as pd

index = pd.MultiIndex.from_tuples(
    [('North', 2023), ('North', 2024),
     ('South', 2023), ('South', 2024)],
    names=['Region', 'Year']
)

df = pd.DataFrame({'Sales': [100, 120, 90, 110]}, index=index)
print(df.loc[('North', 2023)])</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'s56gq','knm65')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('knm65_Dialog','s56gq')">Edit</button>
  </div> <iframe id="knm65" class="result_iframe" style="display: none;"></iframe>
  <div id="knm65_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'s56gq','knm65_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="s56gq" class="textarea_dialog" placeholder="Type HTML here...">import pandas as pd

index = pd.MultiIndex.from_tuples(
    [('North', 2023), ('North', 2024),
     ('South', 2023), ('South', 2024)],
    names=['Region', 'Year']
)

df = pd.DataFrame({'Sales': [100, 120, 90, 110]}, index=index)
print(df.loc[('North', 2023)])</textarea>
     </div>
     <div class="preview-container">
      <iframe id="knm65_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("s56gq"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("s56gq", editor);

}


</script>
 </div>
</div><p><strong>Output:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-bash">Sales    100
Name: (North, 2023), dtype: int64</code></pre>
</div><p>To select all rows for a specific outer level (e.g., all years in the "North" region):</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">print(df.loc['North'])</code></pre>
</div><h3 id="using-slices-in-loc">Using Slices in <code>.loc[]</code></h3><p>You can also use Python's <code>slice()</code> to select a range of index values:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">print(df.loc[('North', slice(2023, 2024))])</code></pre>
</div><p>Or to access all data across regions for a particular year:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">print(df.loc[(slice(None), 2023)])</code></pre>
</div><p>To ensure readable syntax, consider using <code>pd.IndexSlice</code>:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">idx = pd.IndexSlice
print(df.loc[idx[:, 2023], :])</code></pre>
</div><p>This selects all regions for the year 2023.</p><h3 id="the-xs-method-cross-section-selections">The <code>.xs()</code> Method: Cross-Section Selections</h3><p>The <code>.xs()</code> method is ideal for slicing across index levels cleanly, especially when working with multiple levels. For example:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python"># Get all data for the year 2024
print(df.xs(2024, level='Year'))</code></pre>
</div><p>You can also select along columns (if you have a column MultiIndex) by setting <code>axis=1</code>.</p><h3 id="partial-indexing-shorthand">Partial Indexing (Shorthand)</h3><p>Pandas allows <strong>partial indexing</strong> when the index is sorted. If your index is sorted properly, you can omit levels:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df_sorted = df.sort_index()
print(df_sorted.loc['South'])</code></pre>
</div><p>This returns all years for <code>"South"</code>. Keep in mind this only works if the index is <strong>lexsorted</strong>—you can check this with:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df.index.is_lexsorted()  # Deprecated; use df.index.is_monotonic_increasing in newer versions</code></pre>
</div><p>Or sort with:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df = df.sort_index()</code></pre>
</div><h3 id="boolean-selection-with-multiindex">Boolean Selection with MultiIndex</h3><p>You can still use boolean filters on MultiIndex DataFrames. Here's how to select rows with <code>Sales &gt; 100</code>:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">print(df[df['Sales'] &gt; 100])</code></pre>
</div><p>Or filter using index levels:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">print(df[df.index.get_level_values('Region') == 'North'])</code></pre>
</div><p>You can combine these filters too:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">mask = (df.index.get_level_values('Region') == 'North') &amp; (df['Sales'] &gt; 110)
print(df[mask])</code></pre>
</div><h3 id="summary">Summary</h3><p>MultiIndex slicing and selection gives you immense control over complex, hierarchical data. Use <code>.loc[]</code> with tuples and slices for direct access, <code>.xs()</code> for concise cross-sectional views, and boolean logic for conditional filtering. With these tools, you can efficiently query large and structured datasets in a flexible and readable manner.</p><p>In the next section, we’ll learn how to reshape MultiIndexed DataFrames using <code>stack()</code> and <code>unstack()</code>—essential for converting between wide and long formats.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='pandas-for-data-science.htm#advanced-indexing-and-multiindex' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='stacking-and-unstacking-dataframes'>13.3 Stacking and Unstacking DataFrames</h2><p>One of the key strengths of Pandas is its ability to reshape datasets using hierarchical (MultiIndex) structures. Two powerful tools for this are the <code>stack()</code> and <code>unstack()</code> methods. These allow you to pivot your data between wide and long formats, enabling flexible data transformation for analysis or visualization.</p><h3 id="what-are-stack-and-unstack">What Are <code>stack()</code> and <code>unstack()</code>?</h3><ul>
 <li><strong><code>stack()</code></strong>: Moves the <strong>columns</strong> into the <strong>row index</strong> (i.e., pivots columns down into the index).</li>
 <li><strong><code>unstack()</code></strong>: Moves a <strong>level of the index</strong> into the <strong>columns</strong> (i.e., pivots row index into columns).</li>
</ul><p>Both work best on DataFrames with MultiIndexes, either in the index, columns, or both.</p><h3 id="example-basic-stack-and-unstack">Example: Basic Stack and Unstack</h3><p>Start with a simple MultiIndex DataFrame:</p><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import pandas as pd

data = {
    'Q1': [200, 210, 190, 220],
    'Q2': [250, 260, 230, 240]
}

index = pd.MultiIndex.from_product(
    [['North', 'South'], ['2023', '2024']],
    names=['Region', 'Year']
)

df = pd.DataFrame(data, index=index)
print(df)</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'t4dX6','alBEy')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('alBEy_Dialog','t4dX6')">Edit</button>
  </div> <iframe id="alBEy" class="result_iframe" style="display: none;"></iframe>
  <div id="alBEy_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'t4dX6','alBEy_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="t4dX6" class="textarea_dialog" placeholder="Type HTML here...">import pandas as pd

data = {
    'Q1': [200, 210, 190, 220],
    'Q2': [250, 260, 230, 240]
}

index = pd.MultiIndex.from_product(
    [['North', 'South'], ['2023', '2024']],
    names=['Region', 'Year']
)

df = pd.DataFrame(data, index=index)
print(df)</textarea>
     </div>
     <div class="preview-container">
      <iframe id="alBEy_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("t4dX6"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("t4dX6", editor);

}


</script>
 </div>
</div><p><strong>Output:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-bash">Q1   Q2
Region Year         
North  2023  200  250
       2024  210  260
South  2023  190  230
       2024  220  240</code></pre>
</div><h3 id="stacking-wide-long">Stacking: Wide Long</h3><p>Now let’s pivot the columns into a new inner index level:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">stacked = df.stack()
print(stacked)</code></pre>
</div><p><strong>Output:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-bash">Region  Year  Quarter
North   2023  Q1         200
               Q2         250
        2024  Q1         210
               Q2         260
South   2023  Q1         190
               Q2         230
        2024  Q1         220
               Q2         240
dtype: int64</code></pre>
</div><p>The result is a <strong>Series</strong> with a 3-level MultiIndex: <code>Region</code>, <code>Year</code>, and <code>Quarter</code>.</p><p>If you need to keep it as a DataFrame:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">stacked_df = df.stack().to_frame(name='Sales')
print(stacked_df)</code></pre>
</div><h3 id="unstacking-long-wide">Unstacking: Long Wide</h3><p>You can reverse the operation by unstacking:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">unstacked = stacked.unstack()
print(unstacked)</code></pre>
</div><p>You can also specify which level to unstack (e.g., 'Region'):</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">print(stacked.unstack(level='Region'))</code></pre>
</div><p>Or unstack multiple levels:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">print(stacked.unstack(['Region', 'Quarter']))</code></pre>
</div><h3 id="when-to-use-these">When to Use These</h3><ul>
 <li>Use <code>stack()</code> to <strong>compress</strong> wide tables for statistical modeling or export to long-format tools (e.g., Seaborn).</li>
 <li>Use <code>unstack()</code> to <strong>spread out</strong> data, making it easier to visualize comparisons or pivot for reporting.</li>
</ul><h3 id="practical-reshaping-use-case">Practical Reshaping Use Case</h3><p>Imagine you’re analyzing quarterly sales and want to compare <code>Q1</code> vs <code>Q2</code> across regions and years side-by-side:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python"># From long format
df_long = df.stack().reset_index()
df_long.columns = ['Region', 'Year', 'Quarter', 'Sales']

# Pivot to wide format
reshaped = df_long.pivot_table(
    index=['Region', 'Year'],
    columns='Quarter',
    values='Sales'
)

print(reshaped)</code></pre>
</div><h3 id="summary">Summary</h3><p>The <code>stack()</code> and <code>unstack()</code> methods are essential for reshaping DataFrames, especially those with hierarchical structures. They help pivot between long and wide formats depending on your analytical or visualization needs. Mastering these methods will let you adapt data structures fluidly, unlocking deeper insights from complex datasets.</p><p>Next, we’ll apply these transformations to real-world hierarchical data in a full analysis example.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='pandas-for-data-science.htm#advanced-indexing-and-multiindex' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='practical-examples-hierarchical-data-analysis'>13.4 Practical Examples: Hierarchical Data Analysis</h2><p>MultiIndex DataFrames are invaluable for managing complex datasets involving multiple grouping variables, time series, or panel data. By leveraging hierarchical indexes, you can efficiently organize, analyze, and visualize data that spans several dimensions. In this section, we'll explore real-world scenarios where MultiIndexes simplify data handling and insight generation.</p><h3 id="example-1-financial-time-series-with-multiple-assets">Example 1: Financial Time Series with Multiple Assets</h3><p>Imagine you have daily stock price data for multiple companies over several months. Instead of keeping separate DataFrames, a MultiIndex lets you combine and analyze them easily.</p><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import pandas as pd
import numpy as np

# Simulate stock prices for 3 companies over 5 days
dates = pd.date_range('2024-01-01', periods=5)
companies = ['Apple', 'Google', 'Amazon']

# Create MultiIndex from product of companies and dates
index = pd.MultiIndex.from_product([companies, dates], names=['Company', 'Date'])

# Random stock prices
np.random.seed(0)
prices = np.random.uniform(100, 500, size=len(index))

# Build DataFrame
stock_df = pd.DataFrame({'Price': prices}, index=index)
print(stock_df.head(10))</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'sjDwF','aGBjn')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('aGBjn_Dialog','sjDwF')">Edit</button>
  </div> <iframe id="aGBjn" class="result_iframe" style="display: none;"></iframe>
  <div id="aGBjn_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'sjDwF','aGBjn_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="sjDwF" class="textarea_dialog" placeholder="Type HTML here...">import pandas as pd
import numpy as np

# Simulate stock prices for 3 companies over 5 days
dates = pd.date_range('2024-01-01', periods=5)
companies = ['Apple', 'Google', 'Amazon']

# Create MultiIndex from product of companies and dates
index = pd.MultiIndex.from_product([companies, dates], names=['Company', 'Date'])

# Random stock prices
np.random.seed(0)
prices = np.random.uniform(100, 500, size=len(index))

# Build DataFrame
stock_df = pd.DataFrame({'Price': prices}, index=index)
print(stock_df.head(10))</textarea>
     </div>
     <div class="preview-container">
      <iframe id="aGBjn_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("sjDwF"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("sjDwF", editor);

}


</script>
 </div>
</div><p><strong>Output:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-bash">Price
Company Date            
Apple   2024-01-01  344.14
        2024-01-02  404.29
        2024-01-03  456.12
        2024-01-04  348.55
        2024-01-05  259.46
Google  2024-01-01  455.07
        2024-01-02  319.18
        2024-01-03  305.91
        2024-01-04  485.20
        2024-01-05  236.92</code></pre>
</div><h4 id="grouping-and-aggregation">Grouping and Aggregation</h4><p>You can group by one level (e.g., company) to compute average prices:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">avg_prices = stock_df.groupby(level='Company').mean()
print(avg_prices)</code></pre>
</div><p>Output:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-bash">Price
Company             
Amazon      298.02
Apple       362.91
Google      360.06</code></pre>
</div><p>Or analyze price changes over time for each company:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">daily_returns = stock_df.groupby(level='Company').Price.pct_change()
stock_df['Daily Return'] = daily_returns
print(stock_df.head(10))</code></pre>
</div><h3 id="example-2-multi-category-sales-data">Example 2: Multi-Category Sales Data</h3><p>Suppose you have sales data categorized by region, product category, and month:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">regions = ['North', 'South']
categories = ['Electronics', 'Furniture']
months = ['2023-01', '2023-02']

index = pd.MultiIndex.from_product([regions, categories, months],
                                   names=['Region', 'Category', 'Month'])
sales = np.random.randint(1000, 5000, size=len(index))

sales_df = pd.DataFrame({'Sales': sales}, index=index)
print(sales_df)</code></pre>
</div><h4 id="aggregating-across-levels">Aggregating Across Levels</h4><p>Calculate total sales by region (ignoring category and month):</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">total_by_region = sales_df.groupby(level='Region').sum()
print(total_by_region)</code></pre>
</div><p>Or sales by category across all regions and months:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">total_by_category = sales_df.groupby(level='Category').sum()
print(total_by_category)</code></pre>
</div><h3 id="visualization-with-multiindex-dataframes">Visualization with MultiIndex DataFrames</h3><p>Pandas plotting works seamlessly with MultiIndexes. For example, plot monthly sales for each category in the North region:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">import matplotlib.pyplot as plt

north_sales = sales_df.loc['North'].unstack(level='Month')
north_sales.plot(kind='bar')
plt.title('Monthly Sales by Category in North Region')
plt.xlabel('Category')
plt.ylabel('Sales')
plt.show()</code></pre>
</div><p>This visualization clearly contrasts sales trends for Electronics and Furniture over months.</p><h3 id="why-use-multiindex">Why Use MultiIndex?</h3><ul>
 <li><strong>Organizes complex data</strong> intuitively along multiple dimensions.</li>
 <li>Enables <strong>fast group-based computations</strong> and slicing.</li>
 <li>Facilitates reshaping for <strong>reporting and visualization</strong>.</li>
 <li>Maintains a <strong>compact, tabular format</strong> for panel data and time series.</li>
</ul><h3 id="tips-for-working-with-multiindex">Tips for Working with MultiIndex</h3><ul>
 <li>Use <code>.loc</code> with tuples for precise slicing: <code>df.loc[('North', 'Electronics')]</code>.</li>
 <li>Reset index if flat DataFrame needed for export or simpler operations.</li>
 <li>Combine with <code>stack()</code> and <code>unstack()</code> to pivot data as needed.</li>
</ul><h3 id="summary">Summary</h3><p>MultiIndex DataFrames empower you to analyze hierarchical datasets like financial time series and multi-category sales data efficiently. By grouping, aggregating, and visualizing along different index levels, you unlock richer insights without cumbersome manual reshaping. Practice these techniques on your data to harness the full power of Pandas' hierarchical indexing.</p><div class = "chapter-navi-section">
<a href="pandas-for-data-science-performance-optimization-and-best-practices.htm" class="nav-button prev">←</a>
<a href='pandas-for-data-science.htm#advanced-indexing-and-multiindex' class="nav-button toc-link">Index</a>
<a href="pandas-for-data-science-customizing-pandas-with-extensions-and-apis.htm" class="nav-button next">→</a>
</div>
<section class="download-section">
  <div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 18px;color: #333;top: 20px;">Pandas for Data Science</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 90px;height: 90px;top: 70px;" src="data:image/png;base64,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"/>
  </div>
  <div class="download-info">
    <h2 id='bottom'>Download This Ebook</h2>
    <p class="format-label">Available formats:</p>
    <div class="download-buttons">
      <a href="pandas-for-data-science.pdf" class="download-button">📄 PDF</a>
      <a href="pandas-for-data-science.epub" class="download-button">📘 EPUB</a>
    </div>
  </div>
</section><div class='related-books'>
<h2>Python Data Science Books</h2>
<div class='related-book-list'>
<a href="pandas-for-data-science.htm">
<div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 18px;color: #333;top: 20px;">Pandas for Data Science</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 90px;height: 90px;top: 70px;" src="data:image/png;base64,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"/>
  </div>
</a>



<a href='python.htm'><div class='book-cover' style='background-color: #f9f6f1;color: #111111;border: 1px solid #ccc;display: flex;justify-content: center;align-items: center;text-align: center;'>More Python Books</div></a>
</div>
</div><script>
function copyCode(button) {const code = button.nextElementSibling.innerText;navigator.clipboard.writeText(code).then(() => {button.textContent = 'Copied!';setTimeout(() => { button.textContent = 'Copy'; }, 1500);});}
</script></div>
<style>
.site-footer {margin-top: 60px;padding: 20px 0;border-top: 1px solid #eee;text-align: center;font-size: 14px;}
.site-footer a {text-decoration: none;}
.light-mode .site-footer {color: #777;border-color: #eee;}
.dark-mode .site-footer {color: #888;border-color: #333;}
.light-mode .site-footer a {color: #555;}
.dark-mode .site-footer a {color: #aaa;}
.site-footer a:hover {text-decoration: underline;}    
</style>
<footer class="site-footer">
<nav><a href="https://readbytes.github.io">Home</a> |Email:<script type="text/javascript">
var part1 = 'yinpeng';var part6 = '263';var part2 = Math.pow(2,6);var part3 = String.fromCharCode(part2);var part4 = 'hotmail dot com';var part5 = part1 + String.fromCharCode(part2) + part4;document.write(part1 + part6 + part3 + part4);
</script>
| <a id="mode-toggle" href="#">Toggle Dark Mode</a>
</nav><p>© 2025 — All rights reserved.</p></footer>
<script>
const toggleButton = document.getElementById('mode-toggle');
const body = document.body;
const savedMode = localStorage.getItem('mode') || 'light';
body.classList.add(savedMode + '-mode');
toggleButton.addEventListener('click', () => {
      const isDark = body.classList.contains('dark-mode');
      body.classList.toggle('dark-mode', !isDark);
      body.classList.toggle('light-mode', isDark);
      localStorage.setItem('mode', isDark ? 'light' : 'dark');
});
function copyCode(button) {const code = button.nextElementSibling.innerText;navigator.clipboard.writeText(code).then(() => {button.textContent = 'Copied!';setTimeout(() => { button.textContent = 'Copy'; }, 1500);});}
</script>
</body>
</html>