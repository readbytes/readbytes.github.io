<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pandas for Data Science Performance Optimization and Best Practices</title>
<link rel='shortcut icon' href='https://readbytes.github.io/images/favicon.ico'>
<link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css"><style>
html {scroll-behavior: smooth;}  
body {font-family: 'Merriweather', serif;;margin: 0;padding: 2rem 1rem;font-size: 15px;line-height: 1.5;transition: background-color 0.3s, color 0.3s;}
.container {max-width: 750px;margin: 0 auto;padding: 1rem 2rem;}
.light-mode {background-color: #f8f7f5;color: #333;} 
.dark-mode {background-color: #121212;color: #e0e0e0;}
a { text-decoration: none;transition: color 0.2s;}
a:hover {text-decoration: underline;}
.light-mode a {color: #555;}
.dark-mode a {color: #aaa;}
</style><style>
.related-book-list {display: flex;flex-wrap: wrap;gap: 20px;}
.related-books {margin-top: 40px;}
.related-books h2 {font-size: 22px;margin-bottom: 20px;border-bottom: 2px solid #eee;padding-bottom: 8px;}
.light-mode .related-books h2 {color: #333;border-color: #eee;}
.dark-mode .related-books h2 {color: #ddd;border-color: #333;}
</style><style>
.book-cover {width: 130px;height: 180px;font-family: Arial, sans-serif;position: relative;overflow: hidden;box-shadow: 2px 2px 4px rgba(0,0,0,0.1);}
.book-cover-bottom-stripe {position: absolute;bottom: 0;left: 0;height: 5px;width: 100%;}
.book-cover-title {position: absolute;width: 100%;text-align: center;font-weight: bold;}
.book-cover-icon {position: absolute;left: 50%;transform: translateX(-50%);display: flex;align-items: center;justify-content: center;}
.book-cover-author {position: absolute;bottom: 10px;width: 100%;text-align: center;font-size: 8px;color: #333;}
</style><style>
.book-title-toc {font-size: 32px;font-weight: bold; }
.book-subtitle-toc {font-size: 18px;margin-top: 8px;font-style: italic;}
.book-header {text-align: center;margin-bottom: 40px;}

.toc-container {border-radius: 10px;padding: 30px;margin-bottom: 40px;box-shadow: 0 8px 20px rgba(0,0,0,0.05);}
h1 {font-size: 24px;text-align: center;margin-bottom: 30px;letter-spacing: 1px;padding-bottom: 10px;}
.toc-list,.toc-section-list {list-style: none;padding: 0;margin: 0;}
.toc-section-list {padding-left: 18px;margin-top: 6px;margin-bottom: 20px; }
.toc-chapter {padding: 20px 0;}
.chapter-title,.toc-section {display: flex;justify-content: space-between;padding-top: 4px;}
.chapter-title {font-size: 17px;font-weight: bold;}
.chapter-page,.section-page {font-style: italic;}
 
 
.light-mode .book-title-toc,.light-mode .chapter-title,.light-mode .book-name {color: #222;}
.light-mode .book-subtitle-toc,.light-mode .book-sub,.light-mode .chapter-page,.light-mode .section-page {color: #666;}
.light-mode .toc-container { background: #fff;border: 1px solid #ddd;}
.light-mode h1 {border-bottom: 2px solid #eee;color: #222;}
.light-mode .toc-section {  color: #444;}

.light-mode .book-cover { border: 1px solid #ccc;box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);}
.light-mode .book-title,.light-mode .series-name {color: #fff;}
.light-mode .book-subtitle,.light-mode .book-footer {color: #aaa;}

.dark-mode .book-title-toc,.dark-mode .chapter-title,.dark-mode .book-name {color: #f5f5f5;}
.dark-mode .book-subtitle-toc,.dark-mode .book-sub,.dark-mode .chapter-page,.dark-mode .section-page {color: #aaa;}
.dark-mode .toc-container {background: #1e1e1e;border: 1px solid #444;}

.dark-mode h1 {border-bottom: 2px solid #333;color: #eee;}
.dark-mode .toc-section {color: #bbb;}

.dark-mode .related-books h2 {color: #ddd;border-bottom: 2px solid #333;}
.dark-mode .book-title,.dark-mode .series-name {color: #fff;}
.dark-mode .book-subtitle,.dark-mode .book-footer {color: #bbb;}
.dark-mode .toc-section {color: #ddd;}

@media (max-width: 600px) {
  .chapter-title,
  .toc-section {
    flex-direction: column;
    align-items: flex-start;
  }

  .chapter-page,
  .section-page {
    margin-top: 4px;
  }
}

</style><style>
.light-mode .container {box-shadow: 0 0 15px rgba(0,0,0,0.1);}
.dark-mode .container {box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);}

h1, h2, h3 {font-weight: 600;margin-top: 2.5rem;margin-bottom: 1rem;line-height: 1.2;}
h1 { font-size: 1.8rem; }
h2 { font-size: 1.4rem; }
h3 { font-size: 1.2rem; }

table {width: 100%;border-collapse: collapse;font-family: sans-serif;font-size: 1em;margin: 1em 0;}
th, td {padding: 0.6em 1em;text-align: left;border: 1px solid;}
tr:nth-child(even) {  background-color: inherit;}
tr:hover { background-color: inherit;}

code {color: #d35400;}

.chapter-navi-section {display: flex;justify-content: space-between;align-items: center;padding-bottom: 10px;padding-top: 10px;}
.nav-link {color: inherit;text-decoration: none;opacity: 0.5;transition: opacity 0.3s ease, text-decoration 0.3s ease;}
.nav-link:hover {opacity: 0.9;text-decoration: underline;}
.prev { text-align: left; }
.toc-link { text-align: center; }
.next { text-align: right; }

.download-section {display: flex;align-items: center;justify-content: center;gap: 2rem;padding: 2rem 1rem;max-width: 600px;margin: 3rem auto;border-radius: 12px;box-shadow: 0 4px 10px rgba(0,0,0,0.05);}
.download-info h2 {margin: 0 0 0.5rem;font-size: 1.2rem;}
.format-label {margin: 0 0 0.5rem;font-size: 0.95rem;}
.download-buttons {display: flex;gap: 1rem;}
.download-button {background-color: #4A90E2;color: white;padding: 0.5em 1.2em;border-radius: 25px;font-size: 0.95rem;text-decoration: none;transition: background-color 0.3s ease;}
.download-button:hover {background-color: #357ABD;}

.code-block {position: relative;margin-bottom: 1em;}
.copy-button {background: transparent;color: white;position: absolute;top: 8px;right: 8px;border: none;padding: 4px 8px;font-size: 12px;border-radius: 4px;cursor: pointer;z-index: 1;}
.copy-button:hover {background-color: #0056b3;}

.snippet-container {overflow: hidden;}
.snippet-header {padding: 0.75rem 1rem;cursor: pointer;font-size: 1rem;background-color: #eeeeee;color:  #111111; border-radius: 8px;cursor: pointer;box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
.snippet-body {display: none;font-family: monospace;}
.snippet-container.open .snippet-body {display: block;}

.CodeMirror {border: 2px solid #ccc;border-radius: 4px;resize: vertical;}

.light-mode .format-label {color: #888;}
.light-mode th {background-color: #f2f2f2;}
.light-mode tr:nth-child(even) {background-color: #fafafa;}
.light-mode tr:hover {background-color: #e6f7ff;}

.dark-mode .snippet-header {background-color: #333;color:  #ddd; }
.dark-mode .format-label {color: #aaa;}
.dark-mode th {background-color: #333;color: #fff;}
.dark-mode td {border-color: #444;}
.dark-mode tr:nth-child(even) {background-color: #2a2a2a;}
.dark-mode tr:hover {background-color: #2c3e50;}


.button-group-run-edit {display: flex;width: 100%;gap: 1rem;}
.button-run-edit {flex: 1;padding: 1rem;font-size: 1rem;font-weight: 600;border: none;border-radius: 8px;cursor: pointer;transition: background 0.3s, color 0.3s;}

.light-mode .button-run-edit {background-color: #f0f0f0;color: #222;box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);}
.light-mode .button-run-edit:hover {background-color: #e0e0e0;}

.dark-mode .button-run-edit {background-color: #2a2a2a;color: #f5f5f5;box-shadow: 0 0 10px rgba(255, 255, 255, 0.05);}
.dark-mode .button-run-edit:hover {background-color: #3a3a3a;}

button { padding: 0.5em 1em; background: green; color: white; border: none; cursor: pointer; }
button:hover { background: #1e7e34; }
.result_iframe { width:99%; margin-top: 1em;  resize: both;background-color: #515b63;border:1px solid #ccc;}   

.dialog-backdrop {position: fixed;top: 0;left: 0;width: 100vw;height: 100vh;background: rgba(0,0,0,0.5);display: none;justify-content: center;align-items: center;z-index: 10;}
.dialog {background: #90979e;padding: 20px;width: 90vw;height: 80vh;border-radius: 8px;box-shadow: 0 0 20px rgba(0,0,0,0.3);display: flex;flex-direction: column;}
.dialog-content {display: flex;gap: 20px;margin-top: 10px;height: calc(100% - 40px);}
.editor-container, .preview-container {flex: 1;height: 100%;max-height: 100%;overflow: hidden; }
.result_iframe_dialog {width: 100%;height: 100%;resize: both;border:1px solid #ccc;overflow: auto; }   
.CodeMirror {width: 100% !important;height: 100% !important;}
</style><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
<script>
const pythonCodeMirrorMap = new Map();
let pyodide = null;
let pyodideReady = false;
async function main() {
    pyodide = await loadPyodide();
    await pyodide.loadPackage(['numpy','pandas','matplotlib']);
    pyodideReady = true;
}
main();

 async function runPythonCode(button,textarea_id, iframe_id) {
        let code = pythonCodeMirrorMap.get(textarea_id).getValue();
        const iframe = document.getElementById(iframe_id);
        let doc = iframe.contentDocument || iframe.contentWindow.document;
 
        let result = "";

    if (!pyodideReady) {
      result = "Pyodide is still loading... Wait for a while and click Run again.";
    }else{
    try {
      await pyodide.runPythonAsync(`
import sys
from js import console

class CaptureOutput:
    def __init__(self):
        self.data = []
    def write(self, msg):
        self.data.append(msg)
    def flush(self):
        pass

sys.stdout = sys.stderr = capture = CaptureOutput()

${code}

output = "".join(capture.data)
`);
      result = pyodide.globals.get('output');
 
      
    } catch (err) {
      result = "Error:\n" + err;
 
    }
    }

 

      const html = `
    <!DOCTYPE html>
    <html>
      <head>
        <title>Output</title>
        <style>
          body { font-family: monospace; padding: 1em; background: #1e1e1e; color: #eee; }
          pre { white-space: pre-wrap; word-break: break-word; }
          .error { color: red; }
        </style>
      </head>
      <body>
        <pre id="log">${result} </pre>
      </body>
    </html>
  `;
        iframe.style.display = "block";
        iframe.srcdoc = html;  
        

iframe.onload = function () {
  const doc = iframe.contentDocument || iframe.contentWindow.document;
  const contentHeight = Math.max(
    doc.body.scrollHeight,
    doc.documentElement.scrollHeight
  );
  iframe.style.height = contentHeight + 'px';
};

    }
function openEditPythonCodeDialog(id, textarea_id) {
		        closeAllPythonCodeDialog();
		        document.getElementById(id).style.display = 'flex';
         
 	        setTimeout(() => {
		        	 pythonCodeMirrorMap.get(textarea_id).refresh();
                   
 	        }, 100); // 100ms 
}

function closeAllPythonCodeDialog() {
		        document.querySelectorAll('.dialog-backdrop').forEach(el => {
		          el.style.display = 'none';
		        });
}		
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
<script>
const pythonCodeMirrorMap = new Map();
let pyodide = null;
let pyodideReady = false;
async function main() {
    pyodide = await loadPyodide();
    
    pyodideReady = true;
}
main();

 async function runPythonCode(button,textarea_id, iframe_id) {
        let code = pythonCodeMirrorMap.get(textarea_id).getValue();
        const iframe = document.getElementById(iframe_id);
        let doc = iframe.contentDocument || iframe.contentWindow.document;
 
        let result = "";

    if (!pyodideReady) {
      result = "Pyodide is still loading... Wait for a while and click Run again.";
    }else{
    try {
      await pyodide.runPythonAsync(`
import sys
from js import console

class CaptureOutput:
    def __init__(self):
        self.data = []
    def write(self, msg):
        self.data.append(msg)
    def flush(self):
        pass

sys.stdout = sys.stderr = capture = CaptureOutput()

${code}

output = "".join(capture.data)
`);
      result = pyodide.globals.get('output');
 
      
    } catch (err) {
      result = "Error:\n" + err;
 
    }
    }

 

      const html = `
    <!DOCTYPE html>
    <html>
      <head>
        <title>Output</title>
        <style>
          body { font-family: monospace; padding: 1em; background: #1e1e1e; color: #eee; }
          pre { white-space: pre-wrap; word-break: break-word; }
          .error { color: red; }
        </style>
      </head>
      <body>
        <pre id="log">${result} </pre>
      </body>
    </html>
  `;
        iframe.style.display = "block";
        iframe.srcdoc = html;  
        

iframe.onload = function () {
  const doc = iframe.contentDocument || iframe.contentWindow.document;
  const contentHeight = Math.max(
    doc.body.scrollHeight,
    doc.documentElement.scrollHeight
  );
  iframe.style.height = contentHeight + 'px';
};

    }
function openEditPythonCodeDialog(id, textarea_id) {
		        closeAllPythonCodeDialog();
		        document.getElementById(id).style.display = 'flex';
         
 	        setTimeout(() => {
		        	 pythonCodeMirrorMap.get(textarea_id).refresh();
                   
 	        }, 100); // 100ms 
}

function closeAllPythonCodeDialog() {
		        document.querySelectorAll('.dialog-backdrop').forEach(el => {
		          el.style.display = 'none';
		        });
}		
</script>
</head>
<body>
<script>const mode = localStorage.getItem('mode') || 'light';document.documentElement.classList.add(`${mode}-mode`);</script>  
<div class="container"><div class = "chapter-navi-section">
<a href="pandas-for-data-science-visualization-with-pandas.htm" class="nav-button prev">←</a>
<a href='pandas-for-data-science.htm#performance-optimization-and-best-practices' class="nav-button toc-link">Index</a>
<a href="pandas-for-data-science-advanced-indexing-and-multiindex.htm" class="nav-button next">→</a>
</div>
<div class='book-header'><h1 class='book-title-toc' id = 'top'>Performance Optimization and Best Practices</h1><h3 class='book-subtitle-toc'>Pandas for Data Science</h3></div><h2 id='memory-usage-and-dataframe-size-reduction'>12.1 Memory Usage and DataFrame Size Reduction</h2><p>As datasets grow, optimizing memory usage becomes essential for performance, especially on resource-constrained systems or when working with millions of rows. Pandas provides tools to inspect memory usage and offers several strategies to reduce memory footprint efficiently without losing data integrity.</p><h3 id="inspecting-memory-usage">Inspecting Memory Usage</h3><p>The first step is to analyze how much memory your DataFrame consumes. You can use <code>.info()</code> for a general overview and <code>.memory_usage(deep=True)</code> for a detailed, column-level breakdown:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">import pandas as pd
import numpy as np

# Sample dataset
df = pd.DataFrame({
    'ID': range(1, 10001),
    'Category': np.random.choice(['A', 'B', 'C', 'D'], size=10000),
    'Amount': np.random.randint(100, 1000, size=10000),
    'Discount': np.random.rand(10000)
})

print(df.info())
print(df.memory_usage(deep=True))</code></pre>
</div><p>This will show that string-based columns (like <code>Category</code>) and 64-bit numeric types consume substantial memory.</p><h3 id="strategy-1-convert-to-categorical-types">Strategy 1: Convert to Categorical Types</h3><p>For columns with repeated string values (like labels or categories), converting them to the <code>category</code> type can drastically reduce memory usage:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['Category'] = df['Category'].astype('category')</code></pre>
</div><p>This internally maps strings to integer codes, which are far more efficient.</p><h3 id="strategy-2-use-smaller-numeric-types">Strategy 2: Use Smaller Numeric Types</h3><p>By default, pandas uses 64-bit integers and floats (<code>int64</code>, <code>float64</code>). But if your data doesn't require that level of precision, downcasting can help:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['ID'] = pd.to_numeric(df['ID'], downcast='unsigned')
df['Amount'] = pd.to_numeric(df['Amount'], downcast='integer')
df['Discount'] = pd.to_numeric(df['Discount'], downcast='float')</code></pre>
</div><p>You can also use <code>df.dtypes</code> to inspect which columns may be good candidates for downcasting.</p><h3 id="strategy-3-drop-unnecessary-columns">Strategy 3: Drop Unnecessary Columns</h3><p>Columns like unique identifiers, metadata, or redundant features can often be dropped before processing:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df = df.drop(columns=['ID'])  # if not required for analysis</code></pre>
</div><p>Removing even a single high-cardinality or text-heavy column can have a significant impact.</p><h3 id="strategy-4-efficient-indexing">Strategy 4: Efficient Indexing</h3><p>Default integer indexing is fine for most cases, but when working with time series or categorical data, setting an appropriate index can make joins, lookups, and resampling faster and more memory-efficient:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df = df.set_index('Category')  # only if Category is unique or frequently queried</code></pre>
</div><p>Be cautious—setting indexes on high-cardinality columns (e.g., unique IDs) may actually increase memory usage.</p><h3 id="before-and-after-memory-comparison">Before and After: Memory Comparison</h3><p>Let’s compare the memory footprint before and after optimization:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df_orig = pd.DataFrame({
    'ID': range(1, 10001),
    'Category': np.random.choice(['A', 'B', 'C', 'D'], size=10000),
    'Amount': np.random.randint(100, 1000, size=10000),
    'Discount': np.random.rand(10000)
})

print("Original size (MB):", df_orig.memory_usage(deep=True).sum() / 1024 ** 2)

# Optimized version
df_opt = df_orig.copy()
df_opt['Category'] = df_opt['Category'].astype('category')
df_opt['ID'] = pd.to_numeric(df_opt['ID'], downcast='unsigned')
df_opt['Amount'] = pd.to_numeric(df_opt['Amount'], downcast='integer')
df_opt['Discount'] = pd.to_numeric(df_opt['Discount'], downcast='float')

print("Optimized size (MB):", df_opt.memory_usage(deep=True).sum() / 1024 ** 2)</code></pre>
</div><p><strong>Result</strong>: You’ll typically see memory reductions of 40–70% depending on the data composition.</p><h3 id="summary">Summary</h3><p>Optimizing memory usage in pandas is a simple yet powerful way to boost performance. Key techniques include:</p><ul>
 <li>Inspecting memory with <code>.memory_usage(deep=True)</code></li>
 <li>Using <code>category</code> for repetitive string data</li>
 <li>Downcasting numeric types to smaller representations</li>
 <li>Dropping irrelevant columns</li>
 <li>Choosing appropriate indexes</li>
</ul><p>These optimizations make your workflows faster, especially when scaling up to large datasets or preparing for production deployments.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='pandas-for-data-science.htm#performance-optimization-and-best-practices' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='vectorized-operations-vs-loops'>12.2 Vectorized Operations vs Loops</h2><p>When working with pandas, one of the most effective ways to write fast, readable, and scalable code is by using <strong>vectorized operations</strong> instead of traditional Python loops. Vectorization refers to applying operations over entire arrays (or Series/DataFrames) at once using optimized, low-level implementations—typically backed by NumPy.</p><h3 id="why-avoid-loops-in-pandas">Why Avoid Loops in Pandas?</h3><p>Loops in Python (like <code>for</code> or <code>while</code>) are slow because they process one element at a time and operate in the interpreted layer. In contrast, pandas and NumPy vectorized methods run compiled C code under the hood, making them significantly faster.</p><p>Let’s look at an example that illustrates the difference.</p><h3 id="example-adding-two-columns">Example: Adding Two Columns</h3><h4 id="with-a-loop-slow">With a Loop (Slow):</h4><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import pandas as pd
import numpy as np
import time

# Sample DataFrame
df = pd.DataFrame({
    'a': np.random.randint(0, 100, size=100000),
    'b': np.random.randint(0, 100, size=100000)
})

# Using loop
start = time.time()
df['sum_loop'] = [x + y for x, y in zip(df['a'], df['b'])]
end = time.time()
print("Loop time:", round(end - start, 4), "seconds")</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'O925H','UwMWN')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('UwMWN_Dialog','O925H')">Edit</button>
  </div> <iframe id="UwMWN" class="result_iframe" style="display: none;"></iframe>
  <div id="UwMWN_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'O925H','UwMWN_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="O925H" class="textarea_dialog" placeholder="Type HTML here...">import pandas as pd
import numpy as np
import time

# Sample DataFrame
df = pd.DataFrame({
    'a': np.random.randint(0, 100, size=100000),
    'b': np.random.randint(0, 100, size=100000)
})

# Using loop
start = time.time()
df['sum_loop'] = [x + y for x, y in zip(df['a'], df['b'])]
end = time.time()
print("Loop time:", round(end - start, 4), "seconds")</textarea>
     </div>
     <div class="preview-container">
      <iframe id="UwMWN_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("O925H"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("O925H", editor);

}


</script>
 </div>
</div><h4 id="vectorized-fast">Vectorized (Fast):</h4><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">start = time.time()
df['sum_vectorized'] = df['a'] + df['b']
end = time.time()
print("Vectorized time:", round(end - start, 4), "seconds")</code></pre>
</div><p>In practice, the vectorized operation can be <strong>10–100 times faster</strong> than the loop, especially as dataset size increases.</p><h3 id="more-examples-vectorizing-common-tasks">More Examples: Vectorizing Common Tasks</h3><h4 id="squaring-values">Squaring Values</h4><p><strong>Loop:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['squared_loop'] = [x**2 for x in df['a']]</code></pre>
</div><p><strong>Vectorized:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['squared_vec'] = df['a'] ** 2</code></pre>
</div><h4 id="conditional-column">Conditional Column</h4><p>Suppose you want to label values as “high” if &gt; 50, otherwise “low”:</p><p><strong>With Loop:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['label_loop'] = ['high' if x &gt; 50 else 'low' for x in df['a']]</code></pre>
</div><p><strong>Vectorized with <code>np.where()</code>:</strong></p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['label_vec'] = np.where(df['a'] &gt; 50, 'high', 'low')</code></pre>
</div><h4 id="row-wise-mean-avoid-for">Row-wise Mean (Avoid <code>for</code>)</h4><p>Don’t loop row by row—use vectorized methods:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['mean_val'] = df[['a', 'b']].mean(axis=1)</code></pre>
</div><h3 id="summary-table">Summary Table</h3><table>
 <thead>
  <tr>
   <th>Task</th>
   <th>Loop-Based Code</th>
   <th>Vectorized Code</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>Add columns</td>
   <td><code>[x + y for x, y in zip(...)]</code></td>
   <td><code>df['a'] + df['b']</code></td>
  </tr>
  <tr>
   <td>Square values</td>
   <td><code>[x**2 for x in df['a']]</code></td>
   <td><code>df['a'] ** 2</code></td>
  </tr>
  <tr>
   <td>Conditional label</td>
   <td><code>['high' if x &gt; 50 else 'low' ...]</code></td>
   <td><code>np.where(df['a'] &gt; 50, ...)</code></td>
  </tr>
  <tr>
   <td>Row-wise stats</td>
   <td>loop each row manually</td>
   <td><code>df.mean(axis=1)</code></td>
  </tr>
 </tbody>
</table><h3 id="final-thoughts">Final Thoughts</h3><p>Vectorized operations not only provide <strong>significant performance improvements</strong>, especially on large datasets, but also make your code <strong>cleaner and more concise</strong>. Always prefer built-in pandas and NumPy methods for transformations and avoid Python loops unless absolutely necessary. When profiling your code, if it's slow, loops are a good place to start optimizing.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='pandas-for-data-science.htm#performance-optimization-and-best-practices' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='using-eval-and-query-for-speed'>12.3 Using <code>eval()</code> and <code>query()</code> for Speed</h2><p>When working with large DataFrames, performance can become a bottleneck, especially during filtering or when computing new columns with complex expressions. Pandas offers two powerful tools—<code>eval()</code> and <code>query()</code>—to write cleaner, faster, and more memory-efficient code by leveraging optimized expression evaluation using <code>numexpr</code> under the hood.</p><h3 id="what-is-eval">What is <code>eval()</code>?</h3><p><code>DataFrame.eval()</code> evaluates string expressions using column names directly. It's particularly useful for computing new columns or performing arithmetic operations.</p><h4 id="basic-usage">Basic Usage:</h4><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import pandas as pd
import numpy as np

df = pd.DataFrame({
    'a': np.random.randint(1, 100, size=1000000),
    'b': np.random.randint(1, 100, size=1000000),
    'c': np.random.rand(1000000)
})

# Traditional method
df['result'] = df['a'] + df['b'] * df['c']

# Using eval (faster and more concise)
df.eval('result_eval = a + b * c', inplace=True)</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'MYFwC','698T2')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('698T2_Dialog','MYFwC')">Edit</button>
  </div> <iframe id="698T2" class="result_iframe" style="display: none;"></iframe>
  <div id="698T2_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'MYFwC','698T2_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="MYFwC" class="textarea_dialog" placeholder="Type HTML here...">import pandas as pd
import numpy as np

df = pd.DataFrame({
    'a': np.random.randint(1, 100, size=1000000),
    'b': np.random.randint(1, 100, size=1000000),
    'c': np.random.rand(1000000)
})

# Traditional method
df['result'] = df['a'] + df['b'] * df['c']

# Using eval (faster and more concise)
df.eval('result_eval = a + b * c', inplace=True)</textarea>
     </div>
     <div class="preview-container">
      <iframe id="698T2_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("MYFwC"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("MYFwC", editor);

}


</script>
 </div>
</div><p>This avoids the overhead of parsing Python objects repeatedly and improves performance when working with large datasets.</p><h3 id="what-is-query">What is <code>query()</code>?</h3><p><code>DataFrame.query()</code> allows you to filter rows based on string conditions using a SQL-like syntax, making your code both faster and more readable.</p><h4 id="example-filtering-rows">Example: Filtering Rows</h4><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python"># Traditional filtering
filtered = df[(df['a'] &gt; 50) &amp; (df['b'] &lt; 30)]

# Using query (faster and cleaner)
filtered_q = df.query('a &gt; 50 and b &lt; 30')</code></pre>
</div><p>This approach reduces both verbosity and execution time, especially for large data.</p><h3 id="why-use-eval-and-query">Why Use <code>eval()</code> and <code>query()</code>?</h3><ul>
 <li><strong>Performance</strong>: Internally uses <code>numexpr</code> for fast computation on large arrays.</li>
 <li><strong>Memory-efficient</strong>: Reduces intermediate object creation.</li>
 <li><strong>Readability</strong>: Cleaner syntax, especially for complex logic.</li>
 <li><strong>Convenience</strong>: No need to repeat <code>df['col']</code>—just use the column names directly.</li>
</ul><h3 id="practical-examples">Practical Examples</h3><h4 id="creating-new-columns">Creating New Columns</h4><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python"># Compute a weighted score
df.eval('score = 0.6 * a + 0.4 * b', inplace=True)</code></pre>
</div><h4 id="filtering-with-conditions">Filtering with Conditions</h4><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python"># Find rows where score is above 70 and 'c' is below 0.5
high_scores = df.query('score &gt; 70 and c &lt; 0.5')</code></pre>
</div><h4 id="comparing-performance">Comparing Performance</h4><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import time 

# Loop-style filtering
start = time.time()
df[(df['a'] &gt; 50) &amp; (df['b'] &lt; 20)]
print("Loop-style:", round(time.time() - start, 4), "s")

# Query-style filtering
start = time.time()
df.query('a &gt; 50 and b &lt; 20')
print("Query-style:", round(time.time() - start, 4), "s")</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'PRaVI','Z6fq2')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('Z6fq2_Dialog','PRaVI')">Edit</button>
  </div> <iframe id="Z6fq2" class="result_iframe" style="display: none;"></iframe>
  <div id="Z6fq2_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'PRaVI','Z6fq2_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="PRaVI" class="textarea_dialog" placeholder="Type HTML here...">import time 

# Loop-style filtering
start = time.time()
df[(df['a'] &gt; 50) &amp; (df['b'] &lt; 20)]
print("Loop-style:", round(time.time() - start, 4), "s")

# Query-style filtering
start = time.time()
df.query('a &gt; 50 and b &lt; 20')
print("Query-style:", round(time.time() - start, 4), "s")</textarea>
     </div>
     <div class="preview-container">
      <iframe id="Z6fq2_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("PRaVI"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("PRaVI", editor);

}


</script>
 </div>
</div><h3 id="limitations-and-tips">Limitations and Tips</h3><ul>
 <li><p>Both <code>eval()</code> and <code>query()</code> work best with simple arithmetic and logical expressions.</p></li>
 <li><p>Use <code>@</code> to reference Python variables inside queries:</p>
  <div class="code-block">
   <button class="copy-button" onclick="copyCode(this)">▯</button>
   <pre><code class="language-python">threshold = 50
df.query('a &gt; @threshold')</code></pre>
  </div></li>
 <li><p>They may not support complex Python functions or method chains (e.g., <code>.apply()</code>).</p></li>
</ul><h3 id="conclusion">Conclusion</h3><p><code>eval()</code> and <code>query()</code> are excellent tools for optimizing pandas workflows involving computation and filtering. They help reduce code verbosity and improve performance, especially on large datasets. When used judiciously, they can simplify your data transformation pipeline without sacrificing speed.</p><div class = "chapter-navi-section">
<a href="#top" class="nav-button prev">↑</a>
<a href='pandas-for-data-science.htm#performance-optimization-and-best-practices' class="nav-button toc-link">Index</a>
<a href="#bottom" class="nav-button next">↓</a>
</div>
<h2 id='practical-examples-speeding-up-data-processing'>12.4 Practical Examples: Speeding Up Data Processing</h2><p>In this section, we’ll walk through a realistic scenario that highlights how performance optimization techniques—like memory reduction, vectorized operations, and use of <code>eval()</code> and <code>query()</code>—can drastically speed up data processing in pandas. We'll also introduce basic profiling tools to assess performance improvements.</p><h3 id="scenario-processing-retail-transactions">Scenario: Processing Retail Transactions</h3><p>Imagine a dataset containing millions of rows representing retail transactions. We'll optimize the workflow step-by-step.</p><h4 id="step-1-simulate-a-large-dataset">Step 1: Simulate a Large Dataset</h4><div>
 <div class="code-block"><button class="copy-button" onclick="copyCode(this)">▯</button>
  <pre><code class="language-python">import pandas as pd
import numpy as np

# Simulate 1 million transactions
np.random.seed(0)
n = 1_000_000
df = pd.DataFrame({
    'customer_id': np.random.randint(1000, 9999, size=n),
    'product_id': np.random.randint(1, 100, size=n),
    'quantity': np.random.randint(1, 5, size=n),
    'unit_price': np.random.uniform(10, 100, size=n),
    'category': np.random.choice(['A', 'B', 'C', 'D'], size=n),
    'date': pd.date_range('2023-01-01', periods=n, freq='min')
})

print(df.info(memory_usage='deep'))</code></pre>
 </div>
 <div class="snippet-container">
  <div class="button-group-run-edit"><button class="button-run-edit" onclick="runPythonCode(this,'0AD8a','c53xE')">Run</button> <button class="button-run-edit" onclick="openEditPythonCodeDialog('c53xE_Dialog','0AD8a')">Edit</button>
  </div> <iframe id="c53xE" class="result_iframe" style="display: none;"></iframe>
  <div id="c53xE_Dialog" class="dialog-backdrop">
   <div class="dialog">
    <div class="controls"><button onclick="runPythonCode(this,'0AD8a','c53xE_IFrame')">Run</button> <button onclick="closeAllPythonCodeDialog()">Close</button>
    </div>
    <div class="dialog-content">
     <div class="editor-container">
      <textarea id="0AD8a" class="textarea_dialog" placeholder="Type HTML here...">import pandas as pd
import numpy as np

# Simulate 1 million transactions
np.random.seed(0)
n = 1_000_000
df = pd.DataFrame({
    'customer_id': np.random.randint(1000, 9999, size=n),
    'product_id': np.random.randint(1, 100, size=n),
    'quantity': np.random.randint(1, 5, size=n),
    'unit_price': np.random.uniform(10, 100, size=n),
    'category': np.random.choice(['A', 'B', 'C', 'D'], size=n),
    'date': pd.date_range('2023-01-01', periods=n, freq='min')
})

print(df.info(memory_usage='deep'))</textarea>
     </div>
     <div class="preview-container">
      <iframe id="c53xE_IFrame" class="result_iframe_dialog" style="border: none;"></iframe>
     </div>
    </div>
   </div>
  </div>
  <script>
{
let editor = CodeMirror.fromTextArea(document.getElementById("0AD8a"), {
					mode : "python",
					lineNumbers : false,
          lineWrapping: true,
					tabSize : 2
});
const darkmode = localStorage.getItem("mode") || "light";  
const newTheme = darkmode === "dark" ? "dracula" : "default";
editor.setSize("50%", "100%");
editor.setOption("theme", newTheme);
pythonCodeMirrorMap.set("0AD8a", editor);

}


</script>
 </div>
</div><p>This shows high memory usage due to large integer and object columns.</p><h3 id="step-2-reduce-memory-usage">Step 2: Reduce Memory Usage</h3><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['customer_id'] = df['customer_id'].astype('int32')
df['product_id'] = df['product_id'].astype('int16')
df['quantity'] = df['quantity'].astype('int8')
df['category'] = df['category'].astype('category')

print(df.info(memory_usage='deep'))</code></pre>
</div><p><strong>Memory savings</strong>: Reducing column types from <code>int64</code>/<code>object</code> to smaller numerics or <code>category</code> can cut memory by over 50%.</p><h3 id="step-3-use-vectorized-operations">Step 3: Use Vectorized Operations</h3><p>Instead of using loops to compute total transaction value, do:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">df['total_value'] = df['quantity'] * df['unit_price']</code></pre>
</div><p>This vectorized operation is much faster than iterating row by row with <code>.apply()</code> or a <code>for</code> loop.</p><h3 id="step-4-use-eval-and-query-for-speed">Step 4: Use <code>eval()</code> and <code>query()</code> for Speed</h3><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python"># Faster expression evaluation
df.eval('total_eval = quantity * unit_price', inplace=True)

# Efficient filtering with query
high_value = df.query('total_value &gt; 200 and category == "A"')</code></pre>
</div><p>This approach avoids temporary objects and speeds up calculations.</p><h3 id="step-5-profiling-and-benchmarking">Step 5: Profiling and Benchmarking</h3><p>You can use <code>%timeit</code> in Jupyter or <code>time</code> module to compare performance:</p><div class="code-block">
 <button class="copy-button" onclick="copyCode(this)">▯</button>
 <pre><code class="language-python">import time

# Traditional filter
start = time.time()
df[(df['total_value'] &gt; 200) &amp; (df['category'] == 'A')]
print("Loop-style filter:", round(time.time() - start, 4), "s")

# Query-style filter
start = time.time()
df.query('total_value &gt; 200 and category == "A"')
print("Query-style filter:", round(time.time() - start, 4), "s")</code></pre>
</div><p>Expect the <code>query()</code> method to consistently outperform the traditional syntax for large datasets.</p><h3 id="summary-and-best-practices">Summary and Best Practices</h3><ul>
 <li><strong>Convert dtypes</strong> early to reduce memory.</li>
 <li><strong>Prefer vectorized operations</strong> over loops or <code>.apply()</code>.</li>
 <li><strong>Use <code>eval()</code> and <code>query()</code></strong> for large, repeated expressions or filters.</li>
 <li><strong>Profile your code</strong> with <code>%timeit</code>, <code>memory_usage()</code>, and <code>.info()</code> to spot inefficiencies.</li>
</ul><blockquote>
 <p>⚠️ <strong>Caution</strong>: For small datasets, these optimizations may offer negligible gains. Use them where scale and performance matter most.</p>
</blockquote><p>By applying these techniques thoughtfully, you can process millions of rows efficiently and make your data pipelines more robust and scalable.</p><div class = "chapter-navi-section">
<a href="pandas-for-data-science-visualization-with-pandas.htm" class="nav-button prev">←</a>
<a href='pandas-for-data-science.htm#performance-optimization-and-best-practices' class="nav-button toc-link">Index</a>
<a href="pandas-for-data-science-advanced-indexing-and-multiindex.htm" class="nav-button next">→</a>
</div>
<section class="download-section">
  <div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 18px;color: #333;top: 20px;">Pandas for Data Science</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 90px;height: 90px;top: 70px;" src="data:image/png;base64,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"/>
  </div>
  <div class="download-info">
    <h2 id='bottom'>Download This Ebook</h2>
    <p class="format-label">Available formats:</p>
    <div class="download-buttons">
      <a href="pandas-for-data-science.pdf" class="download-button">📄 PDF</a>
      <a href="pandas-for-data-science.epub" class="download-button">📘 EPUB</a>
    </div>
  </div>
</section><div class='related-books'>
<h2>Python Data Science Books</h2>
<div class='related-book-list'>
<a href="pandas-for-data-science.htm">
<div class="book-cover" style="background-color: #f9f6f1;border: 1px solid #ccc;"> 
    <div class="book-cover-title" style="font-size: 18px;color: #333;top: 20px;">Pandas for Data Science</div>
    <div class="book-cover-author">readbytes</div>
    <div class="book-cover-bottom-stripe" style="background-color: #333;"></div>
    <img class="book-cover-icon" style="width: 90px;height: 90px;top: 70px;" src="data:image/png;base64,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"/>
  </div>
</a>



<a href='python.htm'><div class='book-cover' style='background-color: #f9f6f1;color: #111111;border: 1px solid #ccc;display: flex;justify-content: center;align-items: center;text-align: center;'>More Python Books</div></a>
</div>
</div><script>
function copyCode(button) {const code = button.nextElementSibling.innerText;navigator.clipboard.writeText(code).then(() => {button.textContent = 'Copied!';setTimeout(() => { button.textContent = 'Copy'; }, 1500);});}
</script></div>
<style>
.site-footer {margin-top: 60px;padding: 20px 0;border-top: 1px solid #eee;text-align: center;font-size: 14px;}
.site-footer a {text-decoration: none;}
.light-mode .site-footer {color: #777;border-color: #eee;}
.dark-mode .site-footer {color: #888;border-color: #333;}
.light-mode .site-footer a {color: #555;}
.dark-mode .site-footer a {color: #aaa;}
.site-footer a:hover {text-decoration: underline;}    
</style>
<footer class="site-footer">
<nav><a href="https://readbytes.github.io">Home</a> |Email:<script type="text/javascript">
var part1 = 'yinpeng';var part6 = '263';var part2 = Math.pow(2,6);var part3 = String.fromCharCode(part2);var part4 = 'hotmail dot com';var part5 = part1 + String.fromCharCode(part2) + part4;document.write(part1 + part6 + part3 + part4);
</script>
| <a id="mode-toggle" href="#">Toggle Dark Mode</a>
</nav><p>© 2025 — All rights reserved.</p></footer>
<script>
const toggleButton = document.getElementById('mode-toggle');
const body = document.body;
const savedMode = localStorage.getItem('mode') || 'light';
body.classList.add(savedMode + '-mode');
toggleButton.addEventListener('click', () => {
      const isDark = body.classList.contains('dark-mode');
      body.classList.toggle('dark-mode', !isDark);
      body.classList.toggle('light-mode', isDark);
      localStorage.setItem('mode', isDark ? 'light' : 'dark');
});
function copyCode(button) {const code = button.nextElementSibling.innerText;navigator.clipboard.writeText(code).then(() => {button.textContent = 'Copied!';setTimeout(() => { button.textContent = 'Copy'; }, 1500);});}
</script>
</body>
</html>